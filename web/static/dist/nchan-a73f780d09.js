!function(t,e,s){"use strict";var i=function(m,g){var a={};function s(t){return t?e(t):void 0}function e(t){for(var e in s.prototype)t[e]=s.prototype[e];return t}(function(){var u=["responseType","withCredentials","timeout","onprogress"];a.ajax=function(t,s){var e=t.headers||{},i=t.body,r=t.method||(i?"POST":"GET"),n=false;var a=f(t.cors);function o(t,e){return function(){if(!n){s(a.status===g?t:a.status,a.status===0?"Error":a.response||a.responseText||e,a);n=true}}}a.open(r,t.url,true);var h=a.onload=o(200);a.onreadystatechange=function(){if(a.readyState===4)h()};a.onerror=o(null,"Error");a.ontimeout=o(null,"Timeout");a.onabort=o(null,"Abort");if(i){p(e,"X-Requested-With","XMLHttpRequest");if(!m.FormData||!(i instanceof m.FormData)){p(e,"Content-Type","application/x-www-form-urlencoded")}}for(var c=0,l=u.length,d;c<l;c++){d=u[c];if(t[d]!==g)a[d]=t[d]}for(var d in e)a.setRequestHeader(d,e[d]);a.send(i);return a};function f(t){if(t&&m.XDomainRequest&&!/MSIE 1/.test(navigator.userAgent))return new XDomainRequest;if(m.XMLHttpRequest)return new XMLHttpRequest}function p(t,e,s){t[e]=t[e]||s}})(),s.prototype.on=s.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},s.prototype.once=function(t,e){function s(){this.off(t,s),e.apply(this,arguments)}return s.fn=e,this.on(t,s),this},s.prototype.off=s.prototype.removeListener=s.prototype.removeAllListeners=s.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var s=this._callbacks["$"+t];if(!s)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i,r=0;r<s.length;r++)if(i=s[r],i===e||i.fn===e){s.splice(r,1);break}return this},s.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),s=this._callbacks["$"+t];if(s){s=s.slice(0);for(var i=0,r=s.length;r>i;++i)s[i].apply(this,e)}return this},s.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},s.prototype.hasListeners=function(t){return!!this.listeners(t).length};var u=Function.prototype.bind?function t(e,s){return e.bind(s)}:function t(e,s){return function(){e.apply(s,arguments)}},i={},r;function t(t,e){if(this===window){throw"use 'new NchanSubscriber(...)' to initialize"}this.url=t;e=e||{};if(typeof e==="string"){e={subscriber:e}}if(e.transport&&!e.subscriber){e.subscriber=e.transport}if(typeof e.subscriber==="string"){e.subscriber=[e.subscriber]}this.desiredTransport=e.subscriber;if(e.shared){if(!("localStorage"in m)){throw"localStorage unavailable for use in shared NchanSubscriber"}var s="NchanSubscriber:"+this.url+":shared:";var i=function(t){return s+t};var r=m.localStorage;this.shared={id:""+Math.random()+Math.random(),key:i,get:function(t){return r.getItem(i(t))},set:function(t,e){return r.setItem(i(t),e)},setWithId:u(function(t,e){return this.shared.set(t,"##"+this.shared.id+":"+e)},this),getWithId:u(function(t){return this.shared.stripIdFromVal(this.shared.get(t))},this),stripIdFromVal:function(t){if(!t){return t}var e=t.indexOf(":");if(t[0]!=t[1]||t[0]!="#"||!e){return t}return t.substring(e+1,t.length)},remove:function(t){return r.removeItem(i(t))},matchEventKey:u(function(t,e){if(t.storageArea&&t.storageArea!=r){return false}return t.key==i(e)},this),matchEventKeyWithId:u(function(t,e){if(this.shared.matchEventKey(t,e)){var s=t.newValue;var i=s.indexOf(":");if(s[0]!=s[1]||s[0]!="#"||!i){return true}var r=s.substring(2,i);return r!=this.shared.id}else{return false}},this),setRole:u(function(t){if(t=="master"&&this.shared.role!="master"){var e=(new Date).getTime()/1e3;this.shared.setWithId("master:created",e);this.shared.setWithId("master:lastSeen",e)}if(t=="slave"&&!this.lastMessageId){this.lastMessageId=this.shared.get("msg:id")}this.shared.role=t;return this},this),demoteToSlave:u(function(){if(this.shared.role!="master"){throw"can't demote non-master to slave"}if(this.running){this.stop();this.shared.setRole("slave");this.initializeTransport();this.start()}else{this.initializeTransport()}},this),maybePromoteToMaster:u(function(){if(!(this.running||this.starting)){return this}if(this.shared.maybePromotingToMaster){return}this.shared.maybePromotingToMaster=true;var r;var n=2e3;var i=0;var t=Math.random();var a=t;var e;var s=u(function(t){var e=parseFloat(this.shared.getWithId("lotteryTime"));var s=parseFloat(this.shared.getWithId("lottery"));var i=!e||e>(new Date).getTime()-n*2;if(i&&s&&(!a||s>a)){a=s}if(!t){r()}},this);s(true);this.shared.setWithId("lottery",t);this.shared.setWithId("lotteryTime",(new Date).getTime()/1e3);var o=u(function(t){if(this.shared.matchEventKeyWithId(t,"lottery")&&t.newValue){i+=1;var e=parseFloat(this.shared.stripIdFromVal(t.newValue));var s=parseFloat(this.shared.stripIdFromVal(t.oldValue));if(s>e){this.shared.setWithId("lottery",s)}if(!a||e>=a){a=e}}},this);m.addEventListener("storage",o);var h=u(function(){this.shared.maybePromotingToMaster=false;m.removeEventListener("storage",o);if(e){clearInterval(e)}if(this.shared&&this.shared.role=="master"){this.shared.remove("lottery");this.shared.remove("lotteryTime")}if(this.running){this.stop();this.initializeTransport();this.start()}else{this.initializeTransport();if(this.starting){this.start()}}},this);r=u(function(){if(t<a){this.shared.setRole("slave");h()}else if(t>=a){if(i==0){this.shared.setRole("master");h()}else{i=0}}},this);e=m.setInterval(s,n)},this),masterCheckInterval:1e4}}this.lastMessageId=e.id||e.msgId;this.reconnect=typeof e.reconnect=="undefined"?true:e.reconnect;this.reconnectTimeout=e.reconnectTimeout||1e3;var n;if(!e.reconnect){n=function(){}}else{var a="NchanSubscriber:"+t+":lastMessageId";var o;if(e.reconnect=="persist"){o="localStorage"in m&&m.localStorage;if(!o)throw"can't use reconnect: 'persist' option: localStorage not available"}else if(e.reconnect=="session"){o="sessionStorage"in m&&m.sessionStorage;if(!o)throw"can't use reconnect: 'session' option: sessionStorage not available"}else{throw"invalid 'reconnect' option value "+e.reconnect}n=u(function(t){if(this.shared&&this.shared.role=="slave")return;o.setItem(a,t)},this);this.lastMessageId=o.getItem(a)}var h=u(function(){if(this.running){this.stop()}if(this.shared&&this.shared.role=="master"){this.shared.setWithId("status","disconnected")}},this);m.addEventListener("beforeunload",h,false);m.addEventListener("DOMContentLoaded",function(){m.removeEventListener("beforeunload",h,false);m.addEventListener("unload",h,false)},false);var c;if(this.shared){c=u(function(t,e){if(this.shared.role!="master"){return}if(t=="message"){this.shared.set("msg:id",e[1]&&e[1].id||"");this.shared.set("msg:content-type",e[1]&&e[1]["content-type"]||"");this.shared.set("msg",e[0])}else if(t=="error"){}else if(t=="connecting"){this.shared.setWithId("status","connecting")}else if(t=="connect"){this.shared.setWithId("status","connected")}else if(t=="reconnect"){this.shared.setWithId("status","reconnecting")}else if(t=="disconnect"){this.shared.setWithId("status","disconnected")}},this)}else{c=function(){}}var l;var d=u(function(){if(!l&&this.running&&this.reconnect&&!this.transport.reconnecting&&!this.transport.doNotReconnect){c("reconnect");l=m.setTimeout(u(function(){l=null;this.stop();this.start()},this),this.reconnectTimeout)}else{c("disconnect")}},this);this.on("message",function t(t,e){this.lastMessageId=e.id;if(e.id){n(e.id)}c("message",[t,e])});this.on("error",function t(e,s){d(e,s);c("error",[e,s])});this.on("connect",function(){this.connected=true;c("connect")});this.on("__disconnect",function t(e,s){this.connected=false;this.emit("disconnect",e,s);d(e,s)})}function n(t,e){if(e){var s=t.match(/(\?.*)$/);t+=(s?"&":"?")+"last_event_id="+encodeURIComponent(e)}return t}return s(t.prototype),t.prototype.initializeTransport=function(t){if(t&&(this.desiredTransport=t),this.shared&&"slave"==this.shared.role)this.transport=new this.SubscriberClass.__slave(u(this.emit,this));else{var e,s=u(function(t){if(!this.SubscriberClass[t])throw"unknown subscriber type "+t;try{return this.transport=new this.SubscriberClass[t](u(this.emit,this)),this.transport}catch(t){}},this);if(this.desiredTransport)for(e=0;e<this.desiredTransport.length&&!s(this.desiredTransport[e]);e++);else for(e in this.SubscriberClass)if(this.SubscriberClass.hasOwnProperty(e)&&"_"!=e[0]&&s(e))break}if(!this.transport)throw"can't use any transport type"},t.prototype.start=function(){if(this.running)throw"Can't start NchanSubscriber, it's already started.";if(this.starting=!0,this.shared){if(i[this.url]&&i[this.url]!=this)throw"Only 1 shared subscriber allowed per url per window/tab.";if(!(i[this.url]=this).shared.role){var t=this.shared.getWithId("status");r=u(function(t){this.shared.matchEventKeyWithId(t,"status")?"disconnected"==this.shared.stripIdFromVal(t.newValue)&&("slave"==this.shared.role?this.shared.maybePromoteToMaster():this.shared.role):"master"==this.shared.role&&this.shared.matchEventKeyWithId(t,"master:created")&&t.newValue&&this.shared.demoteToSlave()},this),m.addEventListener("storage",r),"disconnected"==t?this.shared.maybePromoteToMaster():(this.shared.setRole(t?"slave":"master"),this.initializeTransport())}"master"==this.shared.role?(this.shared.setWithId("status","connecting"),this.transport.listen(this.url,this.lastMessageId),this.running=!0,delete this.starting,this.shared.masterIntervalCheckID=m.setInterval(u(function(){this.shared.setWithId("master:lastSeen",(new Date).getTime()/1e3)},this),.8*this.shared.masterCheckInterval)):"slave"==this.shared.role&&(this.transport.listen(this.url,this.shared),this.running=!0,delete this.starting,this.shared.masterIntervalCheckID=m.setInterval(u(function(){var t=parseFloat(this.shared.getWithId("master:lastSeen"));(!t||t<(new Date).getTime()/1e3-this.shared.masterCheckInterval/1e3)&&this.shared.maybePromoteToMaster()},this),this.shared.masterCheckInterval))}else this.transport||this.initializeTransport(),this.transport.listen(this.url,this.lastMessageId),this.running=!0,delete this.starting;return this},t.prototype.stop=function(){if(!this.running)throw"Can't stop NchanSubscriber, it's not running.";return this.running=!1,r&&m.removeEventListener("storage",r),this.transport.cancel(),this.shared&&(delete i[this.url],this.shared.masterIntervalCheckID&&(clearInterval(this.shared.masterIntervalCheckID),delete this.shared.masterIntervalCheckID)),this},t.prototype.SubscriberClass={websocket:function(){function t(t){WebSocket,this.emit=t}return t.prototype.websocketizeURL=function(t){var e,s=t.match(/^((\w+:)?\/\/([^\/]+))?(\/)?(.*)/),i=s[2],r=s[3],n=s[4],a=s[5];return"object"==typeof window&&(e=window.location),!i&&e&&(i=e.protocol),i="https:"==i?"wss:":"http:"==i?"ws:":"wss:",!r&&e&&(r=e.host),i+"//"+r+(a=n?"/"+a:e?e.pathname.match(/(.*\/)[^/]*/)[1]+a:"/"+a)},t.prototype.listen=function(t,e){if(t=n(t=this.websocketizeURL(t),e),this.listener)throw"websocket already listening";this.listener=new WebSocket(t,"ws+meta.nchan");var s=this.listener;s.onmessage=u(function(t){var e=t.data.match(/^id: (.*)\n(content-type: (.*)\n)?\n/m);this.emit("message",t.data.substr(e[0].length),{id:e[1],"content-type":e[3]})},this),s.onopen=u(function(t){this.emit("connect",t)},this),s.onerror=u(function(t){this.emit("error",t,s),delete this.listener},this),s.onclose=u(function(t){this.emit("__disconnect",t),delete this.listener},this)},t.prototype.cancel=function(){this.listener&&(this.listener.close(),delete this.listener)},t}(),eventsource:function(){function t(t){EventSource,this.emit=t}return t.prototype.listen=function(t,e){if(t=n(t,e),this.listener)throw"there's a ES listener running already";this.listener=new EventSource(t);var s=this.listener;s.onmessage=u(function(t){this.emit("message",t.data,{id:t.lastEventId})},this),s.onopen=u(function(t){this.reconnecting=!1,this.emit("connect",t)},this),s.onerror=u(function(t){this.listener.readyState!=EventSource.CONNECTING||this.reconnecting?this.emit("__disconnect",t):this.reconnecting||(this.reconnecting=!0,this.emit("__disconnect",t))},this)},t.prototype.cancel=function(){this.listener&&(this.listener.close(),delete this.listener)},t}(),longpoll:function(){function t(t){this.headers={},this.longPollStartTime=null,this.maxLongPollTime=3e5,this.emit=t}return t.prototype.listen=function(t,e){if(this.req)throw"already listening";t&&(this.url=t);var r,n=u(function(t,e){t&&(this.headers[e]=t)},this);return e&&(this.headers={Etag:e}),this.reqStartTime=(new Date).getTime(),r=u(function(t,e,s){if(n(s.getResponseHeader("Last-Modified"),"If-Modified-Since"),n(s.getResponseHeader("Etag"),"If-None-Match"),200<=t&&t<=210){var i=s.getResponseHeader("Content-Type");this.parseMultipartMixedMessage(i,e,s)||this.emit("message",e||"",{"content-type":i,id:this.msgIdFromResponseHeaders(s)}),this.reqStartTime=(new Date).getTime(),this.req=a.ajax({url:this.url,headers:this.headers},r)}else 0==t&&"Error"==e&&4==s.readyState||null===t&&"Abort"!=e?(this.emit("__disconnect",t||0,e),delete this.req):null!==t?(this.emit("error",t,e),delete this.req):(delete this.req,this.emit("__disconnect"))},this),this.reqStartTime=(new Date).getTime(),this.req=a.ajax({url:this.url,headers:this.headers},r),this.emit("connect"),this},t.prototype.parseMultipartMixedMessage=function(t,e,s){var i=t&&t.match(/^multipart\/mixed;\s+boundary=(.*)$/);if(!i)return!1;var r=i[1],n=e.split("--"+r);if(""!=n[0]||!n[n.length-1].match(/--\r?\n/))throw"weird multipart/mixed split";for(var a in n=n.slice(1,-1)){var o=(i=n[a].match(/^(.*)\r?\n\r?\n([\s\S]*)\r?\n$/m))[1].split("\n"),h={};for(var c in o){var l=o[c].match(/^([^:]+):\s+(.*)/);l&&"Content-Type"==l[1]&&(h["content-type"]=l[2])}a==n.length-1&&(h.id=this.msgIdFromResponseHeaders(s)),this.emit("message",i[2],h)}return!0},t.prototype.msgIdFromResponseHeaders=function(t){var e,s;return e=t.getResponseHeader("Last-Modified"),s=t.getResponseHeader("Etag"),e?Date.parse(e)/1e3+":"+(s||"0"):s||null},t.prototype.cancel=function(){return this.req&&(this.req.abort(),delete this.req),this},t}(),__slave:function(){function t(t){this.emit=t,this.doNotReconnect=!0}return t.prototype.listen=function(t,e){this.shared=e,this.statusChangeChecker=u(function(t){if(this.shared.matchEventKey(t,"msg")){var e=this.shared.get("msg:id"),s=this.shared.get("msg:content-type"),i=this.shared.get("msg");this.emit("message",i,{id:""==e?g:e,"content-type":""==s?g:s})}},this),m.addEventListener("storage",this.statusChangeChecker)},t.prototype.cancel=function(){m.removeEventListener("storage",this.statusChangeChecker)},t}()},t}(t);"object"==typeof module&&null!=module&&module.exports?module.exports=i:"function"==typeof define&&define.amd?define(function(){return i}):t.NchanSubscriber=i}("undefined"!=typeof window?window:this);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5jaGFuLmpzIl0sIm5hbWVzIjpbImdsb2JhbCIsIm1vZHVsZU5hbWUiLCJmYWN0b3J5IiwibmV3TW9kdWxlIiwidW5kZWZpbmVkIiwibmFub2FqYXgiLCJFbWl0dGVyIiwidCIsIm1peGluIiwiZSIsInByb3RvdHlwZSIsImFqYXgiLCJyIiwibyIsImEiLCJoZWFkZXJzIiwidSIsImJvZHkiLCJzIiwibWV0aG9kIiwiaSIsImYiLCJjb3JzIiwibCIsInN0YXR1cyIsInJlc3BvbnNlIiwicmVzcG9uc2VUZXh0Iiwib3BlbiIsInVybCIsImQiLCJvbmxvYWQiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJyZWFkeVN0YXRlIiwib25lcnJvciIsIm9udGltZW91dCIsIm9uYWJvcnQiLCJuIiwiRm9ybURhdGEiLCJwIiwiYyIsImxlbmd0aCIsImciLCJzZXRSZXF1ZXN0SGVhZGVyIiwic2VuZCIsIlhEb21haW5SZXF1ZXN0IiwidGVzdCIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsIlhNTEh0dHBSZXF1ZXN0Iiwib24iLCJhZGRFdmVudExpc3RlbmVyIiwidGhpcyIsIl9jYWxsYmFja3MiLCJwdXNoIiwib25jZSIsIm9mZiIsImFwcGx5IiwiYXJndW1lbnRzIiwiZm4iLCJyZW1vdmVMaXN0ZW5lciIsInJlbW92ZUFsbExpc3RlbmVycyIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzcGxpY2UiLCJlbWl0Iiwic2xpY2UiLCJjYWxsIiwibGlzdGVuZXJzIiwiaGFzTGlzdGVuZXJzIiwidWdoYmluZCIsIkZ1bmN0aW9uIiwiYmluZCIsInRoaXNPYmoiLCJzaGFyZWRTdWJzY3JpYmVyVGFibGUiLCJzdG9yYWdlRXZlbnRMaXN0ZW5lciIsIk5jaGFuU3Vic2NyaWJlciIsIm9wdCIsIndpbmRvdyIsInN1YnNjcmliZXIiLCJ0cmFuc3BvcnQiLCJkZXNpcmVkVHJhbnNwb3J0Iiwic2hhcmVkIiwicHJlIiwic2hhcmVkS2V5Iiwia2V5IiwibG9jYWxTdG9yYWdlIiwiaWQiLCJNYXRoIiwicmFuZG9tIiwiZ2V0IiwiZ2V0SXRlbSIsInNldCIsInZhbCIsInNldEl0ZW0iLCJzZXRXaXRoSWQiLCJnZXRXaXRoSWQiLCJzdHJpcElkRnJvbVZhbCIsInNlcCIsImluZGV4T2YiLCJzdWJzdHJpbmciLCJyZW1vdmUiLCJyZW1vdmVJdGVtIiwibWF0Y2hFdmVudEtleSIsImV2Iiwic3RvcmFnZUFyZWEiLCJtYXRjaEV2ZW50S2V5V2l0aElkIiwibmV3VmFsdWUiLCJzZXRSb2xlIiwicm9sZSIsIm5vdyIsIkRhdGUiLCJnZXRUaW1lIiwibGFzdE1lc3NhZ2VJZCIsImRlbW90ZVRvU2xhdmUiLCJydW5uaW5nIiwic3RvcCIsImluaXRpYWxpemVUcmFuc3BvcnQiLCJzdGFydCIsIm1heWJlUHJvbW90ZVRvTWFzdGVyIiwic3RhcnRpbmciLCJtYXliZVByb21vdGluZ1RvTWFzdGVyIiwicHJvY2Vzc1JvbGwiLCJsb3R0ZXJ5Um91bmREdXJhdGlvbiIsImN1cnJlbnRDb250ZW5kZXJzIiwicm9sbCIsImJlc3RSb2xsIiwiY2hlY2tSb2xsSW50ZXJ2YWwiLCJjaGVja1JvbGwiLCJkb250UHJvY2VzcyIsImxhdGVzdFNoYXJlZFJvbGxUaW1lIiwicGFyc2VGbG9hdCIsImxhdGVzdFNoYXJlZFJvbGwiLCJub3RTdGFsZSIsInJvbGxDYWxsYmFjayIsIm5ld1ZhbCIsIm9sZFZhbCIsIm9sZFZhbHVlIiwiZmluaXNoIiwiY2xlYXJJbnRlcnZhbCIsInNldEludGVydmFsIiwibWFzdGVyQ2hlY2tJbnRlcnZhbCIsIm1zZ0lkIiwicmVjb25uZWN0IiwicmVjb25uZWN0VGltZW91dCIsInNhdmVDb25uZWN0aW9uU3RhdGUiLCJpbmRleCIsInN0b3JhZ2UiLCJzZXNzaW9uU3RvcmFnZSIsIm1zZ2lkIiwib25VbmxvYWRFdmVudCIsIm5vdGlmeVNoYXJlZFN1YnNjcmliZXJzIiwibmFtZSIsImRhdGEiLCJyZXN0YXJ0VGltZW91dEluZGV4Iiwic3RvcEhhbmRsZXIiLCJyZWNvbm5lY3RpbmciLCJkb05vdFJlY29ubmVjdCIsInNldFRpbWVvdXQiLCJtc2ciLCJtZXRhIiwiZmFpbCIsImNvZGUiLCJ0ZXh0IiwiY29ubmVjdGVkIiwiYWRkTGFzdE1zZ0lkVG9RdWVyeVN0cmluZyIsIm0iLCJtYXRjaCIsImVuY29kZVVSSUNvbXBvbmVudCIsInBvc3NpYmxlVHJhbnNwb3J0cyIsIlN1YnNjcmliZXJDbGFzcyIsInRyeUluaXRpYWxpemVUcmFuc3BvcnQiLCJlcnIiLCJoYXNPd25Qcm9wZXJ0eSIsImxpc3RlbiIsIm1hc3RlckludGVydmFsQ2hlY2tJRCIsImxhc3RDaGVja2luIiwiY2FuY2VsIiwid2Vic29ja2V0IiwiV1NXcmFwcGVyIiwiV2ViU29ja2V0Iiwid2Vic29ja2V0aXplVVJMIiwibG9jIiwicHJvdG9jb2wiLCJob3N0IiwiYWJzb2x1dGUiLCJwYXRoIiwibG9jYXRpb24iLCJwYXRobmFtZSIsImxpc3RlbmVyIiwib25tZXNzYWdlIiwiZXZ0Iiwic3Vic3RyIiwiY29udGVudC10eXBlIiwib25vcGVuIiwib25jbG9zZSIsImNsb3NlIiwiZXZlbnRzb3VyY2UiLCJFU1dyYXBwZXIiLCJFdmVudFNvdXJjZSIsImxhc3RFdmVudElkIiwiQ09OTkVDVElORyIsImxvbmdwb2xsIiwiTG9uZ3BvbGwiLCJsb25nUG9sbFN0YXJ0VGltZSIsIm1heExvbmdQb2xsVGltZSIsInJlcSIsInJlcXVlc3RDYWxsYmFjayIsInNldEhlYWRlciIsImluY29taW5nIiwiRXRhZyIsInJlcVN0YXJ0VGltZSIsInJlc3BvbnNlX3RleHQiLCJnZXRSZXNwb25zZUhlYWRlciIsImNvbnRlbnRfdHlwZSIsInBhcnNlTXVsdGlwYXJ0TWl4ZWRNZXNzYWdlIiwibXNnSWRGcm9tUmVzcG9uc2VIZWFkZXJzIiwiYm91bmRhcnkiLCJtc2dzIiwic3BsaXQiLCJoZHJzIiwiaiIsImhkciIsImxhc3RNb2RpZmllZCIsImV0YWciLCJwYXJzZSIsImFib3J0IiwiX19zbGF2ZSIsIkxvY2FsU3RvcmVTbGF2ZVRyYW5zcG9ydCIsInN0YXR1c0No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Q2hERCxPQUFPLFdBQWMsT0FBT3BPLElBRTVCSCxFQUFpQixnQkFBSUcsRUFUeEIsQ0FZb0Isb0JBQVh5RSxPQUF5QkEsT0FBU3pCIiwiZmlsZSI6Im5jaGFuLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIE5jaGFuU3Vic2NyaWJlclxuICogdXNhZ2U6IHZhciBzdWIgPSBuZXcgTmNoYW5TdWJzY3JpYmVyKHVybCwgb3B0KTtcbiAqIFxuICogb3B0ID0ge1xuICogICBzdWJzY3JpYmVyOiAnbG9uZ3BvbGwnLCAnZXZlbnRzb3VyY2UnLCBvciAnd2Vic29ja2V0JyxcbiAqICAgICAvL29yIGFuIGFycmF5IG9mIHRoZSBhYm92ZSBpbmRpY2F0aW5nIHN1YnNjcmliZXIgdHlwZSBwcmVmZXJlbmNlXG4gKiAgIHJlY29ubmVjdDogdW5kZWZpbmVkIG9yICdzZXNzaW9uJyBvciAncGVyc2lzdCdcbiAqICAgICAvL2lmIHRoZSBIVE1MNSBzZXNzaW9uU3RvcmUgb3IgbG9jYWxTdG9yZSBzaG91bGQgYmUgdXNlZCB0byByZXN1bWVcbiAqICAgICAvL2Nvbm5lY3Rpb25zIGludGVycnVwdGVkIGJ5IGEgcGFnZSBsb2FkXG4gKiAgIHNoYXJlZDogdHJ1ZSBvciB1bmRlZmluZWRcbiAqICAgICAvL3NoYXJlIGNvbm5lY3Rpb24gdG8gc2FtZSBzdWJzY3JpYmVyIHVybCBiZXR3ZWVuIGJyb3dzZXIgXG4gKiAgICAgLy93aW5kb3dzIGFuZCB0YWJzIHVzaW5nIGxvY2FsU3RvcmFnZS4gSW4gc2hhcmVkIG1vZGUsIFxuICogICAgIC8vb25seSAxIHJ1bm5pbmcgc3Vic2NyaWJlciBpcyBhbGxvd2VkIHBlciB1cmwgcGVyIHdpbmRvdy90YWIuXG4gKiB9XG4gKiBcbiAqIHN1Yi5vbihcIm1lc3NhZ2VcIiwgZnVuY3Rpb24obWVzc2FnZSwgbWVzc2FnZV9tZXRhZGF0YSkge1xuICogICAvLyBtZXNzYWdlIGlzIGEgc3RyaW5nXG4gKiAgIC8vIG1lc3NhZ2VfbWV0YWRhdGEgbWF5IGNvbnRhaW4gJ2lkJyBhbmQgJ2NvbnRlbnQtdHlwZSdcbiAqIH0pO1xuICogXG4gKiBzdWIub24oJ2Nvbm5lY3QnLCBmdW5jdGlvbihldnQpIHtcbiAqICAgLy9maXJlZCB3aGVuIGZpcnN0IGNvbm5lY3RlZC4gXG4gKiB9KTtcbiAqIFxuICogc3ViLm9uKCdkaXNjb25uZWN0JywgZnVuY3Rpb24oZXZ0KSB7XG4gKiAgIC8vIHdoZW4gZGlzY29ubmVjdGVkLlxuICogfSk7XG4gKiBcbiAqIHN1Yi5vbignZXJyb3InLCBmdW5jdGlvbihjb2RlLCBtZXNzYWdlKSB7XG4gKiAgIC8vZXJyb3IgY2FsbGJhY2suIG5vdCBzdXJlIGFib3V0IHRoZSBwYXJhbWV0ZXJzIHlldFxuICogfSk7XG4gKiBcbiAqIHN1Yi5yZWNvbm5lY3Q7IC8vIHNob3VsZCBzdWJzY3JpYmVyIHRyeSB0byByZWNvbm5lY3Q/IHRydWUgYnkgZGVmYXVsdC5cbiAqIHN1Yi5yZWNvbm5lY3RUaW1lb3V0OyAvL2hvdyBsb25nIHRvIHdhaXQgdG8gcmVjb25uZWN0PyBkb2VzIG5vdCBhcHBseSB0byBFdmVudFNvdXJjZSwgd2hpY2ggcmVjb25uZWN0cyBvbiBpdHMgb3duLlxuICogc3ViLmxhc3RNZXNzYWdlSWQ7IC8vbGFzdCBtZXNzYWdlIGlkLiB1c2VmdWwgZm9yIHJlc3VtaW5nIGEgY29ubmVjdGlvbiB3aXRob3V0IGxvc3Mgb3IgcmVwZXRpdGlvbi5cbiAqIFxuICogc3ViLnN0YXJ0KCk7IC8vIGJlZ2luIChvciByZXN1bWUpIHN1YnNjcmliaW5nXG4gKiBzdWIuc3RvcCgpOyAvLyBzdG9wIHN1YnNjcmliZXIuIGRvIG5vdCByZWNvbm5lY3QuXG4gKi9cblxuLy9UaGFua3MgRGFycmVuIFdoaXRsZW4gKCBAcHJhd25zYWxhZCApIGZvciB5b3VyIGZlZWRiYWNrXG5cblxuOyhmdW5jdGlvbiAoZ2xvYmFsLCBtb2R1bGVOYW1lLCBmYWN0b3J5KSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcbiAgXCJ1c2Ugc3RyaWN0XCI7XG4gIC8qIGVzbGludC1kaXNhYmxlIG5vLXVuZGVmICovXG4gIHZhciBuZXdNb2R1bGUgPSBmYWN0b3J5KGdsb2JhbCk7XG4gIGlmICh0eXBlb2YgbW9kdWxlID09PSBcIm9iamVjdFwiICYmIG1vZHVsZSAhPSBudWxsICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBuZXdNb2R1bGU7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQpIHtcbiAgICBkZWZpbmUoZnVuY3Rpb24gKCkgeyByZXR1cm4gbmV3TW9kdWxlOyB9KTtcbiAgfSBlbHNlIHtcbiAgICBnbG9iYWxbbW9kdWxlTmFtZV0gPSBuZXdNb2R1bGU7XG4gIH1cbiAgLyogZXNsaW50LWVuYWJsZSBuby11bmRlZiAqL1xufSkodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHRoaXMsIFwiTmNoYW5TdWJzY3JpYmVyXCIsIGZ1bmN0aW9uIGZhY3RvcnkoZ2xvYmFsLCB1bmRlZmluZWQpIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuXG4vLyBodHRwczovL2dpdGh1Yi5jb20veWFuYXRhbjE2L25hbm9hamF4XG52YXIgbmFub2FqYXg9e307XG4oZnVuY3Rpb24oKXt2YXIgZT1bXCJyZXNwb25zZVR5cGVcIixcIndpdGhDcmVkZW50aWFsc1wiLFwidGltZW91dFwiLFwib25wcm9ncmVzc1wiXTtuYW5vYWpheC5hamF4PWZ1bmN0aW9uKHIsbyl7dmFyIGE9ci5oZWFkZXJzfHx7fSx1PXIuYm9keSxzPXIubWV0aG9kfHwodT9cIlBPU1RcIjpcIkdFVFwiKSxpPWZhbHNlO3ZhciBmPXQoci5jb3JzKTtmdW5jdGlvbiBsKGUsdCl7cmV0dXJuIGZ1bmN0aW9uKCl7aWYoIWkpe28oZi5zdGF0dXM9PT11bmRlZmluZWQ/ZTpmLnN0YXR1cyxmLnN0YXR1cz09PTA/XCJFcnJvclwiOmYucmVzcG9uc2V8fGYucmVzcG9uc2VUZXh0fHx0LGYpO2k9dHJ1ZX19fWYub3BlbihzLHIudXJsLHRydWUpO3ZhciBkPWYub25sb2FkPWwoMjAwKTtmLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpe2lmKGYucmVhZHlTdGF0ZT09PTQpZCgpfTtmLm9uZXJyb3I9bChudWxsLFwiRXJyb3JcIik7Zi5vbnRpbWVvdXQ9bChudWxsLFwiVGltZW91dFwiKTtmLm9uYWJvcnQ9bChudWxsLFwiQWJvcnRcIik7aWYodSl7bihhLFwiWC1SZXF1ZXN0ZWQtV2l0aFwiLFwiWE1MSHR0cFJlcXVlc3RcIik7aWYoIWdsb2JhbC5Gb3JtRGF0YXx8ISh1IGluc3RhbmNlb2YgZ2xvYmFsLkZvcm1EYXRhKSl7bihhLFwiQ29udGVudC1UeXBlXCIsXCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIil9fWZvcih2YXIgcD0wLGM9ZS5sZW5ndGgsZztwPGM7cCsrKXtnPWVbcF07aWYocltnXSE9PXVuZGVmaW5lZClmW2ddPXJbZ119Zm9yKHZhciBnIGluIGEpZi5zZXRSZXF1ZXN0SGVhZGVyKGcsYVtnXSk7Zi5zZW5kKHUpO3JldHVybiBmfTtmdW5jdGlvbiB0KGUpe2lmKGUmJmdsb2JhbC5YRG9tYWluUmVxdWVzdCYmIS9NU0lFIDEvLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpcmV0dXJuIG5ldyBYRG9tYWluUmVxdWVzdDtpZihnbG9iYWwuWE1MSHR0cFJlcXVlc3QpcmV0dXJuIG5ldyBYTUxIdHRwUmVxdWVzdH1mdW5jdGlvbiBuKGUsdCxuKXtlW3RdPWVbdF18fG59fSkoKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuXG5cbiAvLyBodHRwczovL2dpdGh1Yi5jb20vY29tcG9uZW50L2VtaXR0ZXJcbmZ1bmN0aW9uIEVtaXR0ZXIodCl7cmV0dXJuIHQ/bWl4aW4odCk6dm9pZCAwfWZ1bmN0aW9uIG1peGluKHQpe2Zvcih2YXIgZSBpbiBFbWl0dGVyLnByb3RvdHlwZSl0W2VdPUVtaXR0ZXIucHJvdG90eXBlW2VdO3JldHVybiB0fUVtaXR0ZXIucHJvdG90eXBlLm9uPUVtaXR0ZXIucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXI9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5fY2FsbGJhY2tzPXRoaXMuX2NhbGxiYWNrc3x8e30sKHRoaXMuX2NhbGxiYWNrc1tcIiRcIit0XT10aGlzLl9jYWxsYmFja3NbXCIkXCIrdF18fFtdKS5wdXNoKGUpLHRoaXN9LEVtaXR0ZXIucHJvdG90eXBlLm9uY2U9ZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBpKCl7dGhpcy5vZmYodCxpKSxlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1yZXR1cm4gaS5mbj1lLHRoaXMub24odCxpKSx0aGlzfSxFbWl0dGVyLnByb3RvdHlwZS5vZmY9RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXI9RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlQWxsTGlzdGVuZXJzPUVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUV2ZW50TGlzdGVuZXI9ZnVuY3Rpb24odCxlKXtpZih0aGlzLl9jYWxsYmFja3M9dGhpcy5fY2FsbGJhY2tzfHx7fSwwPT1hcmd1bWVudHMubGVuZ3RoKXJldHVybiB0aGlzLl9jYWxsYmFja3M9e30sdGhpczt2YXIgaT10aGlzLl9jYWxsYmFja3NbXCIkXCIrdF07aWYoIWkpcmV0dXJuIHRoaXM7aWYoMT09YXJndW1lbnRzLmxlbmd0aClyZXR1cm4gZGVsZXRlIHRoaXMuX2NhbGxiYWNrc1tcIiRcIit0XSx0aGlzO2Zvcih2YXIgcixzPTA7czxpLmxlbmd0aDtzKyspaWYocj1pW3NdLHI9PT1lfHxyLmZuPT09ZSl7aS5zcGxpY2UocywxKTticmVha31yZXR1cm4gdGhpc30sRW1pdHRlci5wcm90b3R5cGUuZW1pdD1mdW5jdGlvbih0KXt0aGlzLl9jYWxsYmFja3M9dGhpcy5fY2FsbGJhY2tzfHx7fTt2YXIgZT1bXS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSxpPXRoaXMuX2NhbGxiYWNrc1tcIiRcIit0XTtpZihpKXtpPWkuc2xpY2UoMCk7Zm9yKHZhciByPTAscz1pLmxlbmd0aDtzPnI7KytyKWlbcl0uYXBwbHkodGhpcyxlKX1yZXR1cm4gdGhpc30sRW1pdHRlci5wcm90b3R5cGUubGlzdGVuZXJzPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9jYWxsYmFja3M9dGhpcy5fY2FsbGJhY2tzfHx7fSx0aGlzLl9jYWxsYmFja3NbXCIkXCIrdF18fFtdfSxFbWl0dGVyLnByb3RvdHlwZS5oYXNMaXN0ZW5lcnM9ZnVuY3Rpb24odCl7cmV0dXJuISF0aGlzLmxpc3RlbmVycyh0KS5sZW5ndGh9Oy8vIGVzbGludC1kaXNhYmxlLWxpbmVcblxudmFyIHVnaGJpbmQgPSAoRnVuY3Rpb24ucHJvdG90eXBlLmJpbmRcbiAgPyBmdW5jdGlvbiB1Z2hiaW5kKGZuLCB0aGlzT2JqKSB7XG4gICAgcmV0dXJuIGZuLmJpbmQodGhpc09iaik7XG4gIH1cbiAgOiBmdW5jdGlvbiB1Z2hiaW5kKGZuLCB0aGlzT2JqKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgZm4uYXBwbHkodGhpc09iaiwgYXJndW1lbnRzKTtcbiAgICB9O1xuICB9XG4pO1xuXG52YXIgc2hhcmVkU3Vic2NyaWJlclRhYmxlPXt9O1xuXG5cInVzZSBzdHJpY3RcIjsgXG5mdW5jdGlvbiBOY2hhblN1YnNjcmliZXIodXJsLCBvcHQpIHtcbiAgaWYodGhpcyA9PT0gd2luZG93KSB7XG4gICAgdGhyb3cgXCJ1c2UgJ25ldyBOY2hhblN1YnNjcmliZXIoLi4uKScgdG8gaW5pdGlhbGl6ZVwiO1xuICB9XG4gIFxuICB0aGlzLnVybCA9IHVybDtcbiAgb3B0ID0gb3B0IHx8IHt9O1xuICBcbiAgLy93aGljaCB0cmFuc3BvcnQgc2hvdWxkIGkgdXNlP1xuICBpZih0eXBlb2Ygb3B0ID09PSBcInN0cmluZ1wiKSB7XG4gICAgb3B0ID0ge3N1YnNjcmliZXI6IG9wdH07IFxuICB9XG4gIGlmKG9wdC50cmFuc3BvcnQgJiYgIW9wdC5zdWJzY3JpYmVyKSB7XG4gICAgb3B0LnN1YnNjcmliZXIgPSBvcHQudHJhbnNwb3J0O1xuICB9XG4gIGlmKHR5cGVvZiBvcHQuc3Vic2NyaWJlciA9PT0gXCJzdHJpbmdcIikge1xuICAgIG9wdC5zdWJzY3JpYmVyID0gWyBvcHQuc3Vic2NyaWJlciBdO1xuICB9XG4gIHRoaXMuZGVzaXJlZFRyYW5zcG9ydCA9IG9wdC5zdWJzY3JpYmVyO1xuICBcbiAgaWYob3B0LnNoYXJlZCkge1xuICAgIGlmICghKFwibG9jYWxTdG9yYWdlXCIgaW4gZ2xvYmFsKSkge1xuICAgICAgdGhyb3cgXCJsb2NhbFN0b3JhZ2UgdW5hdmFpbGFibGUgZm9yIHVzZSBpbiBzaGFyZWQgTmNoYW5TdWJzY3JpYmVyXCI7XG4gICAgfVxuICAgIFxuICAgIHZhciBwcmUgPSBcIk5jaGFuU3Vic2NyaWJlcjpcIiArIHRoaXMudXJsICsgXCI6c2hhcmVkOlwiO1xuICAgIHZhciBzaGFyZWRLZXkgPSBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHByZSArIGtleTsgfTtcbiAgICB2YXIgbG9jYWxTdG9yYWdlID0gZ2xvYmFsLmxvY2FsU3RvcmFnZTtcbiAgICB0aGlzLnNoYXJlZCA9IHtcbiAgICAgIGlkOiBcIlwiICsgTWF0aC5yYW5kb20oKSArIE1hdGgucmFuZG9tKCksXG4gICAgICBrZXk6IHNoYXJlZEtleSxcbiAgICAgIGdldDogZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgIHJldHVybiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShzaGFyZWRLZXkoa2V5KSk7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbihrZXksIHZhbCkge1xuICAgICAgICByZXR1cm4gbG9jYWxTdG9yYWdlLnNldEl0ZW0oc2hhcmVkS2V5KGtleSksIHZhbCk7XG4gICAgICB9LFxuICAgICAgc2V0V2l0aElkOiB1Z2hiaW5kKGZ1bmN0aW9uKGtleSwgdmFsKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNoYXJlZC5zZXQoa2V5LCBcIiMjXCIgKyB0aGlzLnNoYXJlZC5pZCArIFwiOlwiICsgdmFsKTtcbiAgICAgIH0sIHRoaXMpLFxuICAgICAgZ2V0V2l0aElkOiB1Z2hiaW5kKGZ1bmN0aW9uKGtleSkge1xuICAgICAgICByZXR1cm4gdGhpcy5zaGFyZWQuc3RyaXBJZEZyb21WYWwodGhpcy5zaGFyZWQuZ2V0KGtleSkpO1xuICAgICAgfSwgdGhpcyksXG4gICAgICBzdHJpcElkRnJvbVZhbDogZnVuY3Rpb24odmFsKSB7XG4gICAgICAgIGlmKCF2YWwpIHtcbiAgICAgICAgICByZXR1cm4gdmFsO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzZXAgPSB2YWwuaW5kZXhPZihcIjpcIik7XG4gICAgICAgIGlmKHZhbFswXSE9dmFsWzFdIHx8IHZhbFswXSE9XCIjXCIgfHwgIXNlcCkge1xuICAgICAgICAgIC8vdGhyb3cgXCJub3QgYW4gZXZlbnQgdmFsdWUgd2l0aCBpZFwiO1xuICAgICAgICAgIHJldHVybiB2YWw7IC8vZm9yIGJhY2t3YXJkcy1jb21wYXRpYmlsaXR5XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbC5zdWJzdHJpbmcoc2VwKzEsIHZhbC5sZW5ndGgpO1xuICAgICAgfSxcbiAgICAgIHJlbW92ZTogZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgIHJldHVybiBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShzaGFyZWRLZXkoa2V5KSk7XG4gICAgICB9LFxuICAgICAgbWF0Y2hFdmVudEtleTogdWdoYmluZChmdW5jdGlvbihldiwga2V5KSB7XG4gICAgICAgIGlmKGV2LnN0b3JhZ2VBcmVhICYmIGV2LnN0b3JhZ2VBcmVhICE9IGxvY2FsU3RvcmFnZSl7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBldi5rZXkgPT0gc2hhcmVkS2V5KGtleSk7XG4gICAgICB9LCB0aGlzKSxcbiAgICAgIG1hdGNoRXZlbnRLZXlXaXRoSWQ6IHVnaGJpbmQoZnVuY3Rpb24oZXYsIGtleSkge1xuICAgICAgICBpZih0aGlzLnNoYXJlZC5tYXRjaEV2ZW50S2V5KGV2LCBrZXkpKSB7XG4gICAgICAgICAgdmFyIHZhbCA9IGV2Lm5ld1ZhbHVlO1xuICAgICAgICAgIHZhciBzZXAgPSB2YWwuaW5kZXhPZihcIjpcIik7XG4gICAgICAgICAgaWYodmFsWzBdIT12YWxbMV0gfHwgdmFsWzBdIT1cIiNcIiB8fCAhc2VwKSB7XG4gICAgICAgICAgICAvL3Rocm93IFwibm90IGFuIGV2ZW50IHZhbHVlIHdpdGggaWRcIjtcbiAgICAgICAgICAgIHJldHVybiB0cnVlOyAvL2ZvciBiYWNrd2FyZHMtY29tcGF0aWJpbGl0eVxuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgaWQgPSB2YWwuc3Vic3RyaW5nKDIsIHNlcCk7XG4gICAgICAgICAgcmV0dXJuIChpZCAhPSB0aGlzLnNoYXJlZC5pZCk7IC8vaWdub3JlIG93biBldmVudHMgKGFjY29tb2RhdGlvbnMgZm9yIElFLiBGdWNraW4nIElFLCBldmVuIGFmdGVyIGFsbCB0aGVzZSB5ZWFycy4uLilcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH0sIHRoaXMpLFxuICAgICAgc2V0Um9sZTogdWdoYmluZChmdW5jdGlvbihyb2xlKSB7XG4gICAgICAgIC8vY29uc29sZS5sb2codGhpcy51cmwsIFwic2V0IHNoYXJlZCByb2xlIHRvIFwiLCByb2xlKTtcbiAgICAgICAgaWYocm9sZSA9PSBcIm1hc3RlclwiICYmIHRoaXMuc2hhcmVkLnJvbGUgIT0gXCJtYXN0ZXJcIikge1xuICAgICAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKS8xMDAwO1xuICAgICAgICAgIHRoaXMuc2hhcmVkLnNldFdpdGhJZChcIm1hc3RlcjpjcmVhdGVkXCIsIG5vdyk7XG4gICAgICAgICAgdGhpcy5zaGFyZWQuc2V0V2l0aElkKFwibWFzdGVyOmxhc3RTZWVuXCIsIG5vdyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYocm9sZSA9PSBcInNsYXZlXCIgJiYgIXRoaXMubGFzdE1lc3NhZ2VJZCkge1xuICAgICAgICAgIHRoaXMubGFzdE1lc3NhZ2VJZCA9IHRoaXMuc2hhcmVkLmdldChcIm1zZzppZFwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNoYXJlZC5yb2xlID0gcm9sZTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9LCB0aGlzKSxcbiAgICAgIFxuICAgICAgZGVtb3RlVG9TbGF2ZTogdWdoYmluZChmdW5jdGlvbigpIHtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcImRlbW90ZSB0byBzbGF2ZVwiKTtcbiAgICAgICAgaWYodGhpcy5zaGFyZWQucm9sZSAhPSBcIm1hc3RlclwiKSB7XG4gICAgICAgICAgdGhyb3cgXCJjYW4ndCBkZW1vdGUgbm9uLW1hc3RlciB0byBzbGF2ZVwiO1xuICAgICAgICB9XG4gICAgICAgIGlmKHRoaXMucnVubmluZykge1xuICAgICAgICAgIHRoaXMuc3RvcCgpO1xuICAgICAgICAgIHRoaXMuc2hhcmVkLnNldFJvbGUoXCJzbGF2ZVwiKTtcbiAgICAgICAgICB0aGlzLmluaXRpYWxpemVUcmFuc3BvcnQoKTtcbiAgICAgICAgICB0aGlzLnN0YXJ0KCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgdGhpcy5pbml0aWFsaXplVHJhbnNwb3J0KCk7XG4gICAgICAgIH1cbiAgICAgIH0sIHRoaXMpLFxuICAgICAgXG4gICAgICBtYXliZVByb21vdGVUb01hc3RlcjogdWdoYmluZChmdW5jdGlvbigpIHtcbiAgICAgICAgaWYoISh0aGlzLnJ1bm5pbmcgfHwgdGhpcy5zdGFydGluZykpIHtcbiAgICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMudXJsLCBcInN0b3BwZWQgU3Vic2NyaWJlciB3b24ndCBiZSBwcm9tb3RlZCB0byBtYXN0ZXJcIik7XG4gICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYodGhpcy5zaGFyZWQubWF5YmVQcm9tb3RpbmdUb01hc3Rlcikge1xuICAgICAgICAgIC8vY29uc29sZS5sb2codGhpcy51cmwsIFwiIGFscmVhZHkgbWF5YmVQcm9tb3RpbmdUb01hc3RlclwiKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zaGFyZWQubWF5YmVQcm9tb3RpbmdUb01hc3RlciA9IHRydWU7XG4gICAgICAgIFxuICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMudXJsLCBcIm1heWJlIHByb21vdGUgdG8gbWFzdGVyXCIpO1xuICAgICAgICB2YXIgcHJvY2Vzc1JvbGw7XG4gICAgICAgIFxuICAgICAgICB2YXIgbG90dGVyeVJvdW5kRHVyYXRpb24gPSAyMDAwO1xuICAgICAgICB2YXIgY3VycmVudENvbnRlbmRlcnMgPSAwO1xuICAgICAgICBcbiAgICAgICAgLy9yb2xsIHRoZSBkaWNlXG4gICAgICAgIHZhciByb2xsID0gTWF0aC5yYW5kb20oKTtcbiAgICAgICAgdmFyIGJlc3RSb2xsID0gcm9sbDtcbiAgICAgICAgXG4gICAgICAgIHZhciBjaGVja1JvbGxJbnRlcnZhbDtcbiAgICAgICAgdmFyIGNoZWNrUm9sbCA9IHVnaGJpbmQoZnVuY3Rpb24oZG9udFByb2Nlc3MpIHtcbiAgICAgICAgICB2YXIgbGF0ZXN0U2hhcmVkUm9sbFRpbWUgPSBwYXJzZUZsb2F0KHRoaXMuc2hhcmVkLmdldFdpdGhJZChcImxvdHRlcnlUaW1lXCIpKTtcbiAgICAgICAgICB2YXIgbGF0ZXN0U2hhcmVkUm9sbCA9IHBhcnNlRmxvYXQodGhpcy5zaGFyZWQuZ2V0V2l0aElkKFwibG90dGVyeVwiKSk7XG4gICAgICAgICAgdmFyIG5vdFN0YWxlID0gIWxhdGVzdFNoYXJlZFJvbGxUaW1lIHx8IChsYXRlc3RTaGFyZWRSb2xsVGltZSA+IChuZXcgRGF0ZSgpLmdldFRpbWUoKSAtIGxvdHRlcnlSb3VuZER1cmF0aW9uICogMikpO1xuICAgICAgICAgIGlmKG5vdFN0YWxlICYmIGxhdGVzdFNoYXJlZFJvbGwgJiYgKCFiZXN0Um9sbCB8fCBsYXRlc3RTaGFyZWRSb2xsID4gYmVzdFJvbGwpKSB7XG4gICAgICAgICAgICBiZXN0Um9sbCA9IGxhdGVzdFNoYXJlZFJvbGw7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmKCFkb250UHJvY2Vzcykge1xuICAgICAgICAgICAgcHJvY2Vzc1JvbGwoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIHRoaXMpO1xuICAgICAgICBcbiAgICAgICAgY2hlY2tSb2xsKHRydWUpO1xuICAgICAgICB0aGlzLnNoYXJlZC5zZXRXaXRoSWQoXCJsb3R0ZXJ5XCIsIHJvbGwpO1xuICAgICAgICB0aGlzLnNoYXJlZC5zZXRXaXRoSWQoXCJsb3R0ZXJ5VGltZVwiLCBuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApO1xuICAgICAgICBcbiAgICAgICAgdmFyIHJvbGxDYWxsYmFjayA9IHVnaGJpbmQoZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgICBpZih0aGlzLnNoYXJlZC5tYXRjaEV2ZW50S2V5V2l0aElkKGV2LCBcImxvdHRlcnlcIikgJiYgZXYubmV3VmFsdWUpIHtcbiAgICAgICAgICAgIGN1cnJlbnRDb250ZW5kZXJzICs9IDE7XG4gICAgICAgICAgICB2YXIgbmV3VmFsID0gcGFyc2VGbG9hdCh0aGlzLnNoYXJlZC5zdHJpcElkRnJvbVZhbChldi5uZXdWYWx1ZSkpO1xuICAgICAgICAgICAgdmFyIG9sZFZhbCA9IHBhcnNlRmxvYXQodGhpcy5zaGFyZWQuc3RyaXBJZEZyb21WYWwoZXYub2xkVmFsdWUpKTtcbiAgICAgICAgICAgIGlmKG9sZFZhbCA+IG5ld1ZhbCkge1xuICAgICAgICAgICAgICB0aGlzLnNoYXJlZC5zZXRXaXRoSWQoXCJsb3R0ZXJ5XCIsIG9sZFZhbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmKCFiZXN0Um9sbCB8fCBuZXdWYWwgPj0gYmVzdFJvbGwpIHtcbiAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIm5ldyBiZXN0Um9sbFwiLCBuZXdWYWwpO1xuICAgICAgICAgICAgICBiZXN0Um9sbCA9IG5ld1ZhbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sIHRoaXMpO1xuICAgICAgICBnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcihcInN0b3JhZ2VcIiwgcm9sbENhbGxiYWNrKTtcbiAgICAgICAgXG4gICAgICAgIHZhciBmaW5pc2ggPSB1Z2hiaW5kKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIC8vY29uc29sZS5sb2coXCJmaW5pc2hcIik7XG4gICAgICAgICAgdGhpcy5zaGFyZWQubWF5YmVQcm9tb3RpbmdUb01hc3RlciA9IGZhbHNlO1xuICAgICAgICAgIC8vY29uc29sZS5sb2codGhpcy51cmwsIHRoaXMuc2hhcmVkLnJvbGUpO1xuICAgICAgICAgIGdsb2JhbC5yZW1vdmVFdmVudExpc3RlbmVyKFwic3RvcmFnZVwiLCByb2xsQ2FsbGJhY2spO1xuICAgICAgICAgIGlmKGNoZWNrUm9sbEludGVydmFsKSB7XG4gICAgICAgICAgICBjbGVhckludGVydmFsKGNoZWNrUm9sbEludGVydmFsKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYodGhpcy5zaGFyZWQgJiYgdGhpcy5zaGFyZWQucm9sZSA9PSBcIm1hc3RlclwiKSB7XG4gICAgICAgICAgICB0aGlzLnNoYXJlZC5yZW1vdmUoXCJsb3R0ZXJ5XCIpO1xuICAgICAgICAgICAgdGhpcy5zaGFyZWQucmVtb3ZlKFwibG90dGVyeVRpbWVcIik7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmKHRoaXMucnVubmluZykge1xuICAgICAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgICAgICB0aGlzLmluaXRpYWxpemVUcmFuc3BvcnQoKTtcbiAgICAgICAgICAgIHRoaXMuc3RhcnQoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmluaXRpYWxpemVUcmFuc3BvcnQoKTtcbiAgICAgICAgICAgIGlmKHRoaXMuc3RhcnRpbmcpIHtcbiAgICAgICAgICAgICAgdGhpcy5zdGFydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSwgdGhpcyk7XG4gICAgICAgIFxuICAgICAgICBwcm9jZXNzUm9sbCA9IHVnaGJpbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgLy9jb25zb2xlLmxvZyhcInJvbGwsIGJlc3Ryb2xsXCIsIHJvbGwsIGJlc3RSb2xsKTtcbiAgICAgICAgICBpZihyb2xsIDwgYmVzdFJvbGwpIHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2codGhpcy51cmwsIFwibG9zZXJcIik7XG4gICAgICAgICAgICB0aGlzLnNoYXJlZC5zZXRSb2xlKFwic2xhdmVcIik7XG4gICAgICAgICAgICBmaW5pc2goKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZihyb2xsID49IGJlc3RSb2xsKSB7XG4gICAgICAgICAgICAvL3ZhciBub3cgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDA7XG4gICAgICAgICAgICAvL3ZhciBsb3R0ZXJ5VGltZSA9IHBhcnNlRmxvYXQodGhpcy5zaGFyZWQuZ2V0V2l0aElkKFwibG90dGVyeVRpbWVcIikpO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhsb3R0ZXJ5VGltZSwgbm93IC0gbG90dGVyeVJvdW5kRHVyYXRpb24vMTAwMCk7XG4gICAgICAgICAgICBpZihjdXJyZW50Q29udGVuZGVycyA9PSAwKSB7XG4gICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJ3aW5uZXIsIG5vIG1vcmUgY29udGVuZGVycyFcIik7XG4gICAgICAgICAgICAgIHRoaXMuc2hhcmVkLnNldFJvbGUoXCJtYXN0ZXJcIik7XG4gICAgICAgICAgICAgIGZpbmlzaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJ3aW5uaW5nLCBidXQgaGF2ZSBjb250ZW5kZXJzXCIsIGN1cnJlbnRDb250ZW5kZXJzKTtcbiAgICAgICAgICAgICAgY3VycmVudENvbnRlbmRlcnMgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSwgdGhpcyk7XG4gICAgICAgIFxuICAgICAgICBjaGVja1JvbGxJbnRlcnZhbCA9IGdsb2JhbC5zZXRJbnRlcnZhbChjaGVja1JvbGwsIGxvdHRlcnlSb3VuZER1cmF0aW9uKTtcbiAgICAgIH0sIHRoaXMpLFxuICAgICAgbWFzdGVyQ2hlY2tJbnRlcnZhbDogMTAwMDBcbiAgICB9O1xuICB9XG4gIFxuICB0aGlzLmxhc3RNZXNzYWdlSWQgPSBvcHQuaWQgfHwgb3B0Lm1zZ0lkO1xuICB0aGlzLnJlY29ubmVjdCA9IHR5cGVvZiBvcHQucmVjb25uZWN0ID09IFwidW5kZWZpbmVkXCIgPyB0cnVlIDogb3B0LnJlY29ubmVjdDtcbiAgdGhpcy5yZWNvbm5lY3RUaW1lb3V0ID0gb3B0LnJlY29ubmVjdFRpbWVvdXQgfHwgMTAwMDtcbiAgXG4gIFxuICB2YXIgc2F2ZUNvbm5lY3Rpb25TdGF0ZTtcbiAgaWYoIW9wdC5yZWNvbm5lY3QpIHtcbiAgICBzYXZlQ29ubmVjdGlvblN0YXRlID0gZnVuY3Rpb24oKSB7fTtcbiAgfVxuICBlbHNlIHtcbiAgICB2YXIgaW5kZXggPSBcIk5jaGFuU3Vic2NyaWJlcjpcIiArIHVybCArIFwiOmxhc3RNZXNzYWdlSWRcIjtcbiAgICB2YXIgc3RvcmFnZTtcbiAgICBpZihvcHQucmVjb25uZWN0ID09IFwicGVyc2lzdFwiKSB7XG4gICAgICBzdG9yYWdlID0gKFwibG9jYWxTdG9yYWdlXCIgaW4gZ2xvYmFsKSAmJiBnbG9iYWwubG9jYWxTdG9yYWdlO1xuICAgICAgaWYoIXN0b3JhZ2UpXG4gICAgICAgIHRocm93IFwiY2FuJ3QgdXNlIHJlY29ubmVjdDogJ3BlcnNpc3QnIG9wdGlvbjogbG9jYWxTdG9yYWdlIG5vdCBhdmFpbGFibGVcIjtcbiAgICB9XG4gICAgZWxzZSBpZihvcHQucmVjb25uZWN0ID09IFwic2Vzc2lvblwiKSB7XG4gICAgICBzdG9yYWdlID0gKFwic2Vzc2lvblN0b3JhZ2VcIiBpbiBnbG9iYWwpICYmIGdsb2JhbC5zZXNzaW9uU3RvcmFnZTtcbiAgICAgIGlmKCFzdG9yYWdlKVxuICAgICAgICB0aHJvdyBcImNhbid0IHVzZSByZWNvbm5lY3Q6ICdzZXNzaW9uJyBvcHRpb246IHNlc3Npb25TdG9yYWdlIG5vdCBhdmFpbGFibGVcIjtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB0aHJvdyBcImludmFsaWQgJ3JlY29ubmVjdCcgb3B0aW9uIHZhbHVlIFwiICsgb3B0LnJlY29ubmVjdDtcbiAgICB9XG4gICAgc2F2ZUNvbm5lY3Rpb25TdGF0ZSA9IHVnaGJpbmQoZnVuY3Rpb24obXNnaWQpIHtcbiAgICAgIGlmKHRoaXMuc2hhcmVkICYmIHRoaXMuc2hhcmVkLnJvbGUgPT0gXCJzbGF2ZVwiKSByZXR1cm47XG4gICAgICBzdG9yYWdlLnNldEl0ZW0oaW5kZXgsIG1zZ2lkKTtcbiAgICB9LCB0aGlzKTtcbiAgICB0aGlzLmxhc3RNZXNzYWdlSWQgPSBzdG9yYWdlLmdldEl0ZW0oaW5kZXgpO1xuICB9XG4gIFxuICB2YXIgb25VbmxvYWRFdmVudCA9IHVnaGJpbmQoZnVuY3Rpb24oKSB7XG4gICAgaWYodGhpcy5ydW5uaW5nKSB7XG4gICAgICB0aGlzLnN0b3AoKTtcbiAgICB9XG4gICAgaWYodGhpcy5zaGFyZWQgJiYgdGhpcy5zaGFyZWQucm9sZSA9PSBcIm1hc3RlclwiKSB7XG4gICAgICB0aGlzLnNoYXJlZC5zZXRXaXRoSWQoJ3N0YXR1cycsIFwiZGlzY29ubmVjdGVkXCIpO1xuICAgIH1cbiAgfSwgdGhpcyk7XG4gIGdsb2JhbC5hZGRFdmVudExpc3RlbmVyKCdiZWZvcmV1bmxvYWQnLCBvblVubG9hZEV2ZW50LCBmYWxzZSk7XG4gIC8vIHN3YXAgYGJlZm9yZXVubG9hZGAgdG8gYHVubG9hZGAgYWZ0ZXIgRE9NIGlzIGxvYWRlZFxuICBnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCkge1xuICAgIGdsb2JhbC5yZW1vdmVFdmVudExpc3RlbmVyKCdiZWZvcmV1bmxvYWQnLCBvblVubG9hZEV2ZW50LCBmYWxzZSk7XG4gICAgZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoJ3VubG9hZCcsIG9uVW5sb2FkRXZlbnQsIGZhbHNlKTtcbiAgfSwgZmFsc2UpO1xuICBcbiAgXG4gIHZhciBub3RpZnlTaGFyZWRTdWJzY3JpYmVycztcbiAgaWYodGhpcy5zaGFyZWQpIHtcbiAgICBub3RpZnlTaGFyZWRTdWJzY3JpYmVycyA9IHVnaGJpbmQoZnVuY3Rpb24obmFtZSwgZGF0YSkge1xuICAgICAgaWYodGhpcy5zaGFyZWQucm9sZSAhPSBcIm1hc3RlclwiKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYobmFtZSA9PSBcIm1lc3NhZ2VcIikge1xuICAgICAgICB0aGlzLnNoYXJlZC5zZXQoXCJtc2c6aWRcIiwgZGF0YVsxXSAmJiBkYXRhWzFdLmlkIHx8IFwiXCIpO1xuICAgICAgICB0aGlzLnNoYXJlZC5zZXQoXCJtc2c6Y29udGVudC10eXBlXCIsIGRhdGFbMV0gJiYgZGF0YVsxXVtcImNvbnRlbnQtdHlwZVwiXSB8fCBcIlwiKTtcbiAgICAgICAgdGhpcy5zaGFyZWQuc2V0KFwibXNnXCIsIGRhdGFbMF0pO1xuICAgICAgfVxuICAgICAgZWxzZSBpZihuYW1lID09IFwiZXJyb3JcIikge1xuICAgICAgICAvL1RPRE8gXG4gICAgICB9XG4gICAgICBlbHNlIGlmKG5hbWUgPT0gXCJjb25uZWN0aW5nXCIpIHtcbiAgICAgICAgdGhpcy5zaGFyZWQuc2V0V2l0aElkKFwic3RhdHVzXCIsIFwiY29ubmVjdGluZ1wiKTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYobmFtZSA9PSBcImNvbm5lY3RcIikge1xuICAgICAgICB0aGlzLnNoYXJlZC5zZXRXaXRoSWQoXCJzdGF0dXNcIiwgXCJjb25uZWN0ZWRcIik7XG4gICAgICB9XG4gICAgICBlbHNlIGlmKG5hbWUgPT0gXCJyZWNvbm5lY3RcIikge1xuICAgICAgICB0aGlzLnNoYXJlZC5zZXRXaXRoSWQoXCJzdGF0dXNcIiwgXCJyZWNvbm5lY3RpbmdcIik7XG4gICAgICB9XG4gICAgICBlbHNlIGlmKG5hbWUgPT0gXCJkaXNjb25uZWN0XCIpIHtcbiAgICAgICAgdGhpcy5zaGFyZWQuc2V0V2l0aElkKFwic3RhdHVzXCIsIFwiZGlzY29ubmVjdGVkXCIpO1xuICAgICAgfVxuICAgIH0sIHRoaXMpO1xuICB9XG4gIGVsc2Uge1xuICAgIG5vdGlmeVNoYXJlZFN1YnNjcmliZXJzID0gZnVuY3Rpb24oKXt9O1xuICB9XG4gIFxuICB2YXIgcmVzdGFydFRpbWVvdXRJbmRleDtcbiAgdmFyIHN0b3BIYW5kbGVyID0gdWdoYmluZChmdW5jdGlvbigpIHtcbiAgICBpZighcmVzdGFydFRpbWVvdXRJbmRleCAmJiB0aGlzLnJ1bm5pbmcgJiYgdGhpcy5yZWNvbm5lY3QgJiYgIXRoaXMudHJhbnNwb3J0LnJlY29ubmVjdGluZyAmJiAhdGhpcy50cmFuc3BvcnQuZG9Ob3RSZWNvbm5lY3QpIHtcbiAgICAgIC8vY29uc29sZS5sb2coXCJzdG9wSEFuZGxlciByZWNvbm5lY3QgcGx6XCIsIHRoaXMucnVubmluZywgdGhpcy5yZWNvbm5lY3QpO1xuICAgICAgbm90aWZ5U2hhcmVkU3Vic2NyaWJlcnMoXCJyZWNvbm5lY3RcIik7XG4gICAgICByZXN0YXJ0VGltZW91dEluZGV4ID0gZ2xvYmFsLnNldFRpbWVvdXQodWdoYmluZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmVzdGFydFRpbWVvdXRJbmRleCA9IG51bGw7XG4gICAgICAgIHRoaXMuc3RvcCgpO1xuICAgICAgICB0aGlzLnN0YXJ0KCk7XG4gICAgICB9LCB0aGlzKSwgdGhpcy5yZWNvbm5lY3RUaW1lb3V0KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBub3RpZnlTaGFyZWRTdWJzY3JpYmVycyhcImRpc2Nvbm5lY3RcIik7XG4gICAgfVxuICB9LCB0aGlzKTtcbiAgXG4gIHRoaXMub24oXCJtZXNzYWdlXCIsIGZ1bmN0aW9uIG1zZyhtc2csIG1ldGEpIHtcbiAgICB0aGlzLmxhc3RNZXNzYWdlSWQ9bWV0YS5pZDtcbiAgICBpZihtZXRhLmlkKSB7XG4gICAgICBzYXZlQ29ubmVjdGlvblN0YXRlKG1ldGEuaWQpO1xuICAgIH1cbiAgICBub3RpZnlTaGFyZWRTdWJzY3JpYmVycyhcIm1lc3NhZ2VcIiwgW21zZywgbWV0YV0pO1xuICAgIC8vY29uc29sZS5sb2cobXNnLCBtZXRhKTtcbiAgfSk7XG4gIHRoaXMub24oXCJlcnJvclwiLCBmdW5jdGlvbiBmYWlsKGNvZGUsIHRleHQpIHtcbiAgICBzdG9wSGFuZGxlcihjb2RlLCB0ZXh0KTtcbiAgICBub3RpZnlTaGFyZWRTdWJzY3JpYmVycyhcImVycm9yXCIsIFtjb2RlLCB0ZXh0XSk7XG4gICAgLy9jb25zb2xlLmxvZyhcImZhaWx1cmVcIiwgY29kZSwgdGV4dCk7XG4gIH0pO1xuICB0aGlzLm9uKFwiY29ubmVjdFwiLCBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmNvbm5lY3RlZCA9IHRydWU7XG4gICAgbm90aWZ5U2hhcmVkU3Vic2NyaWJlcnMoXCJjb25uZWN0XCIpO1xuICB9KTtcbiAgdGhpcy5vbihcIl9fZGlzY29ubmVjdFwiLCBmdW5jdGlvbiBmYWlsKGNvZGUsIHRleHQpIHtcbiAgICB0aGlzLmNvbm5lY3RlZCA9IGZhbHNlO1xuICAgIHRoaXMuZW1pdChcImRpc2Nvbm5lY3RcIiwgY29kZSwgdGV4dCk7XG4gICAgc3RvcEhhbmRsZXIoY29kZSwgdGV4dCk7XG4gICAgLy9jb25zb2xlLmxvZyhcIl9fZGlzY29ubmVjdFwiLCBjb2RlLCB0ZXh0KTtcbiAgfSk7XG59XG5cbkVtaXR0ZXIoTmNoYW5TdWJzY3JpYmVyLnByb3RvdHlwZSk7XG5cbk5jaGFuU3Vic2NyaWJlci5wcm90b3R5cGUuaW5pdGlhbGl6ZVRyYW5zcG9ydCA9IGZ1bmN0aW9uKHBvc3NpYmxlVHJhbnNwb3J0cykge1xuICBpZihwb3NzaWJsZVRyYW5zcG9ydHMpIHtcbiAgICB0aGlzLmRlc2lyZWRUcmFuc3BvcnQgPSBwb3NzaWJsZVRyYW5zcG9ydHM7XG4gIH1cbiAgaWYodGhpcy5zaGFyZWQgJiYgdGhpcy5zaGFyZWQucm9sZSA9PSBcInNsYXZlXCIpIHtcbiAgICB0aGlzLnRyYW5zcG9ydCA9IG5ldyB0aGlzLlN1YnNjcmliZXJDbGFzc1tcIl9fc2xhdmVcIl0odWdoYmluZCh0aGlzLmVtaXQsIHRoaXMpKTsgLy90cnkgaXRcbiAgfVxuICBlbHNlIHtcbiAgICB2YXIgdHJ5SW5pdGlhbGl6ZVRyYW5zcG9ydCA9IHVnaGJpbmQoZnVuY3Rpb24obmFtZSkge1xuICAgICAgaWYoIXRoaXMuU3Vic2NyaWJlckNsYXNzW25hbWVdKSB7XG4gICAgICAgIHRocm93IFwidW5rbm93biBzdWJzY3JpYmVyIHR5cGUgXCIgKyBuYW1lO1xuICAgICAgfVxuICAgICAgdHJ5IHtcbiAgICAgICAgdGhpcy50cmFuc3BvcnQgPSBuZXcgdGhpcy5TdWJzY3JpYmVyQ2xhc3NbbmFtZV0odWdoYmluZCh0aGlzLmVtaXQsIHRoaXMpKTsgLy90cnkgaXRcbiAgICAgICAgcmV0dXJuIHRoaXMudHJhbnNwb3J0O1xuICAgICAgfSBjYXRjaChlcnIpIHsgLyptZWguLi4qLyB9XG4gICAgfSwgdGhpcyk7XG4gICAgXG4gICAgdmFyIGk7XG4gICAgaWYodGhpcy5kZXNpcmVkVHJhbnNwb3J0KSB7XG4gICAgICBmb3IoaT0wOyBpPHRoaXMuZGVzaXJlZFRyYW5zcG9ydC5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZih0cnlJbml0aWFsaXplVHJhbnNwb3J0KHRoaXMuZGVzaXJlZFRyYW5zcG9ydFtpXSkpIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIGZvcihpIGluIHRoaXMuU3Vic2NyaWJlckNsYXNzKSB7XG4gICAgICAgIGlmICh0aGlzLlN1YnNjcmliZXJDbGFzcy5oYXNPd25Qcm9wZXJ0eShpKSAmJiBpWzBdICE9IFwiX1wiICYmIHRyeUluaXRpYWxpemVUcmFuc3BvcnQoaSkpIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICBpZighIHRoaXMudHJhbnNwb3J0KSB7XG4gICAgdGhyb3cgXCJjYW4ndCB1c2UgYW55IHRyYW5zcG9ydCB0eXBlXCI7XG4gIH1cbn07XG5cbnZhciBzdG9yYWdlRXZlbnRMaXN0ZW5lcjtcblxuTmNoYW5TdWJzY3JpYmVyLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uKCkge1xuICBpZih0aGlzLnJ1bm5pbmcpXG4gICAgdGhyb3cgXCJDYW4ndCBzdGFydCBOY2hhblN1YnNjcmliZXIsIGl0J3MgYWxyZWFkeSBzdGFydGVkLlwiO1xuICBcbiAgdGhpcy5zdGFydGluZyA9IHRydWU7XG4gIFxuICBpZih0aGlzLnNoYXJlZCkge1xuICAgIGlmKHNoYXJlZFN1YnNjcmliZXJUYWJsZVt0aGlzLnVybF0gJiYgc2hhcmVkU3Vic2NyaWJlclRhYmxlW3RoaXMudXJsXSAhPSB0aGlzKSB7XG4gICAgICB0aHJvdyBcIk9ubHkgMSBzaGFyZWQgc3Vic2NyaWJlciBhbGxvd2VkIHBlciB1cmwgcGVyIHdpbmRvdy90YWIuXCI7XG4gICAgfVxuICAgIHNoYXJlZFN1YnNjcmliZXJUYWJsZVt0aGlzLnVybF0gPSB0aGlzO1xuICAgIFxuICAgIGlmKCF0aGlzLnNoYXJlZC5yb2xlKSB7XG4gICAgICB2YXIgc3RhdHVzID0gdGhpcy5zaGFyZWQuZ2V0V2l0aElkKFwic3RhdHVzXCIpO1xuICAgICAgc3RvcmFnZUV2ZW50TGlzdGVuZXIgPSB1Z2hiaW5kKGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgIGlmKHRoaXMuc2hhcmVkLm1hdGNoRXZlbnRLZXlXaXRoSWQoZXYsIFwic3RhdHVzXCIpKSB7XG4gICAgICAgICAgdmFyIG5ld1ZhbHVlID0gdGhpcy5zaGFyZWQuc3RyaXBJZEZyb21WYWwoZXYubmV3VmFsdWUpO1xuICAgICAgICAgIGlmKG5ld1ZhbHVlID09IFwiZGlzY29ubmVjdGVkXCIpIHtcbiAgICAgICAgICAgIGlmKHRoaXMuc2hhcmVkLnJvbGUgPT0gXCJzbGF2ZVwiKSB7XG4gICAgICAgICAgICAgIC8vcGxheSB0aGUgcHJvbW90aW9uIGxvdHRlcnlcbiAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLnVybCwgXCJzdGF0dXMgY2hhbmdlZCB0byBkaXNjb25uZWN0ZWQsIG1heWJlcHJvbW90ZXRvbWFzdGVyXCIsIGV2Lm5ld1ZhbHVlLCBldi5vbGRWYWx1ZSk7XG4gICAgICAgICAgICAgIHRoaXMuc2hhcmVkLm1heWJlUHJvbW90ZVRvTWFzdGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKHRoaXMuc2hhcmVkLnJvbGUgPT0gXCJtYXN0ZXJcIikge1xuICAgICAgICAgICAgICAvL2RvIG5vdGhpbmdcbiAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLnVybCwgXCJjdXJyZW50IHJvbGUgaXMgbWFzdGVyLCBkbyBub3RoaW5nPy4uLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZih0aGlzLnNoYXJlZC5yb2xlID09IFwibWFzdGVyXCIgJiYgdGhpcy5zaGFyZWQubWF0Y2hFdmVudEtleVdpdGhJZChldiwgXCJtYXN0ZXI6Y3JlYXRlZFwiKSAmJiBldi5uZXdWYWx1ZSkge1xuICAgICAgICAgIC8vYSBuZXcgbWFzdGVyIGhhcyBhcnJpdmVkLiBkZW1vdGUgdG8gc2xhdmUuXG4gICAgICAgICAgdGhpcy5zaGFyZWQuZGVtb3RlVG9TbGF2ZSgpO1xuICAgICAgICB9XG4gICAgICB9LCB0aGlzKTtcbiAgICAgIGdsb2JhbC5hZGRFdmVudExpc3RlbmVyKFwic3RvcmFnZVwiLCBzdG9yYWdlRXZlbnRMaXN0ZW5lcik7XG4gICAgICBpZihzdGF0dXMgPT0gXCJkaXNjb25uZWN0ZWRcIikge1xuICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMudXJsLCBcInN0YXR1cyA9PSBkaXNjb25uZWN0ZWQsIG1heWJlcHJvbW90ZXRvbWFzdGVyXCIpO1xuICAgICAgICB0aGlzLnNoYXJlZC5tYXliZVByb21vdGVUb01hc3RlcigpO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIHRoaXMuc2hhcmVkLnNldFJvbGUoc3RhdHVzID8gXCJzbGF2ZVwiIDogXCJtYXN0ZXJcIik7XG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZVRyYW5zcG9ydCgpO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBpZih0aGlzLnNoYXJlZC5yb2xlID09IFwibWFzdGVyXCIpIHtcbiAgICAgIHRoaXMuc2hhcmVkLnNldFdpdGhJZChcInN0YXR1c1wiLCBcImNvbm5lY3RpbmdcIik7XG4gICAgICB0aGlzLnRyYW5zcG9ydC5saXN0ZW4odGhpcy51cmwsIHRoaXMubGFzdE1lc3NhZ2VJZCk7XG4gICAgICB0aGlzLnJ1bm5pbmcgPSB0cnVlO1xuICAgICAgZGVsZXRlIHRoaXMuc3RhcnRpbmc7XG4gICAgICBcbiAgICAgIC8vbWFzdGVyIGNoZWNraW4gaW50ZXJ2YWxcbiAgICAgIHRoaXMuc2hhcmVkLm1hc3RlckludGVydmFsQ2hlY2tJRCA9IGdsb2JhbC5zZXRJbnRlcnZhbCh1Z2hiaW5kKGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnNoYXJlZC5zZXRXaXRoSWQoXCJtYXN0ZXI6bGFzdFNlZW5cIiwgbmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwKTtcbiAgICAgIH0sIHRoaXMpLCB0aGlzLnNoYXJlZC5tYXN0ZXJDaGVja0ludGVydmFsICogMC44KTtcbiAgICB9XG4gICAgZWxzZSBpZih0aGlzLnNoYXJlZC5yb2xlID09IFwic2xhdmVcIikge1xuICAgICAgdGhpcy50cmFuc3BvcnQubGlzdGVuKHRoaXMudXJsLCB0aGlzLnNoYXJlZCk7XG4gICAgICB0aGlzLnJ1bm5pbmcgPSB0cnVlO1xuICAgICAgZGVsZXRlIHRoaXMuc3RhcnRpbmc7XG4gICAgICBcbiAgICAgIC8vc2xhdmUgY2hlY2sgaWYgbWFzdGVyIGlzIGFyb3VuZFxuICAgICAgdGhpcy5zaGFyZWQubWFzdGVySW50ZXJ2YWxDaGVja0lEID0gZ2xvYmFsLnNldEludGVydmFsKHVnaGJpbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBsYXN0Q2hlY2tpbiA9IHBhcnNlRmxvYXQodGhpcy5zaGFyZWQuZ2V0V2l0aElkKFwibWFzdGVyOmxhc3RTZWVuXCIpKTtcbiAgICAgICAgaWYoIWxhc3RDaGVja2luIHx8IGxhc3RDaGVja2luIDwgKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8gMTAwMCkgLSB0aGlzLnNoYXJlZC5tYXN0ZXJDaGVja0ludGVydmFsIC8gMTAwMCkge1xuICAgICAgICAgIC8vbWFzdGVyIGhhc24ndCBjaGVja2VkIGluIGZvciB0b28gbG9uZy4gYXNzdW1lIGl0J3MgZ29uZS5cbiAgICAgICAgICB0aGlzLnNoYXJlZC5tYXliZVByb21vdGVUb01hc3RlcigpO1xuICAgICAgICB9XG4gICAgICB9LCB0aGlzKSwgdGhpcy5zaGFyZWQubWFzdGVyQ2hlY2tJbnRlcnZhbCk7XG4gICAgfVxuICB9XG4gIGVsc2Uge1xuICAgIGlmKCF0aGlzLnRyYW5zcG9ydCkge1xuICAgICAgdGhpcy5pbml0aWFsaXplVHJhbnNwb3J0KCk7XG4gICAgfVxuICAgIHRoaXMudHJhbnNwb3J0Lmxpc3Rlbih0aGlzLnVybCwgdGhpcy5sYXN0TWVzc2FnZUlkKTtcbiAgICB0aGlzLnJ1bm5pbmcgPSB0cnVlO1xuICAgIGRlbGV0ZSB0aGlzLnN0YXJ0aW5nO1xuICB9XG4gIHJldHVybiB0aGlzO1xufTtcblxuTmNoYW5TdWJzY3JpYmVyLnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24oKSB7XG4gIGlmKCF0aGlzLnJ1bm5pbmcpXG4gICAgdGhyb3cgXCJDYW4ndCBzdG9wIE5jaGFuU3Vic2NyaWJlciwgaXQncyBub3QgcnVubmluZy5cIjtcbiAgXG4gIHRoaXMucnVubmluZyA9IGZhbHNlO1xuICBpZihzdG9yYWdlRXZlbnRMaXN0ZW5lcikge1xuICAgIGdsb2JhbC5yZW1vdmVFdmVudExpc3RlbmVyKFwic3RvcmFnZVwiLCBzdG9yYWdlRXZlbnRMaXN0ZW5lcik7XG4gIH1cbiAgdGhpcy50cmFuc3BvcnQuY2FuY2VsKCk7XG4gIGlmKHRoaXMuc2hhcmVkKSB7XG4gICAgZGVsZXRlIHNoYXJlZFN1YnNjcmliZXJUYWJsZVt0aGlzLnVybF07XG4gICAgaWYodGhpcy5zaGFyZWQubWFzdGVySW50ZXJ2YWxDaGVja0lEKSB7XG4gICAgICBjbGVhckludGVydmFsKHRoaXMuc2hhcmVkLm1hc3RlckludGVydmFsQ2hlY2tJRCk7XG4gICAgICBkZWxldGUgdGhpcy5zaGFyZWQubWFzdGVySW50ZXJ2YWxDaGVja0lEO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdGhpcztcbn07XG5cbmZ1bmN0aW9uIGFkZExhc3RNc2dJZFRvUXVlcnlTdHJpbmcodXJsLCBtc2dpZCkge1xuICBpZihtc2dpZCkge1xuICAgIHZhciBtID0gdXJsLm1hdGNoKC8oXFw/LiopJC8pO1xuICAgIHVybCArPSAobSA/IFwiJlwiIDogXCI/XCIpICsgXCJsYXN0X2V2ZW50X2lkPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KG1zZ2lkKTtcbiAgfVxuICByZXR1cm4gdXJsO1xufVxuXG5OY2hhblN1YnNjcmliZXIucHJvdG90eXBlLlN1YnNjcmliZXJDbGFzcyA9IHtcbiAgJ3dlYnNvY2tldCc6IChmdW5jdGlvbigpIHtcbiAgICBmdW5jdGlvbiBXU1dyYXBwZXIoZW1pdCkge1xuICAgICAgV2ViU29ja2V0O1xuICAgICAgdGhpcy5lbWl0ID0gZW1pdDtcbiAgICB9XG4gICAgXG4gICAgV1NXcmFwcGVyLnByb3RvdHlwZS53ZWJzb2NrZXRpemVVUkwgPSBmdW5jdGlvbih1cmwpIHtcbiAgICAgIHZhciBtID0gdXJsLm1hdGNoKC9eKChcXHcrOik/XFwvXFwvKFteXFwvXSspKT8oXFwvKT8oLiopLyk7XG4gICAgICB2YXIgcHJvdG9jb2wgPSBtWzJdO1xuICAgICAgdmFyIGhvc3QgPSBtWzNdO1xuICAgICAgdmFyIGFic29sdXRlID0gbVs0XTtcbiAgICAgIHZhciBwYXRoID0gbVs1XTtcbiAgICAgIFxuICAgICAgdmFyIGxvYztcbiAgICAgIGlmKHR5cGVvZiB3aW5kb3cgPT0gXCJvYmplY3RcIikge1xuICAgICAgICBsb2MgPSB3aW5kb3cubG9jYXRpb247XG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmKCFwcm90b2NvbCAmJiBsb2MpIHtcbiAgICAgICAgcHJvdG9jb2wgPSBsb2MucHJvdG9jb2w7XG4gICAgICB9XG4gICAgICBpZihwcm90b2NvbCA9PSBcImh0dHBzOlwiKSB7XG4gICAgICAgIHByb3RvY29sID0gXCJ3c3M6XCI7XG4gICAgICB9XG4gICAgICBlbHNlIGlmKHByb3RvY29sID09IFwiaHR0cDpcIikge1xuICAgICAgICBwcm90b2NvbCA9IFwid3M6XCI7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgcHJvdG9jb2wgPSBcIndzczpcIjsgLy9kZWZhdWx0IHNldHRpbmc6IHNlY3VyZVxuICAgICAgfVxuICAgICAgXG4gICAgICBpZighaG9zdCAmJiBsb2MpIHtcbiAgICAgICAgaG9zdCA9IGxvYy5ob3N0O1xuICAgICAgfVxuICAgICAgXG4gICAgICBpZighYWJzb2x1dGUpIHtcbiAgICAgICAgcGF0aCA9IGxvYyA/IGxvYy5wYXRobmFtZS5tYXRjaCgvKC4qXFwvKVteL10qLylbMV0gKyBwYXRoIDogXCIvXCIgKyBwYXRoO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIHBhdGggPSBcIi9cIiArIHBhdGg7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBwcm90b2NvbCArIFwiLy9cIiArIGhvc3QgKyBwYXRoO1xuICAgIH07XG4gICAgXG4gICAgV1NXcmFwcGVyLnByb3RvdHlwZS5saXN0ZW4gPSBmdW5jdGlvbih1cmwsIG1zZ2lkKSB7XG4gICAgICB1cmwgPSB0aGlzLndlYnNvY2tldGl6ZVVSTCh1cmwpO1xuICAgICAgdXJsID0gYWRkTGFzdE1zZ0lkVG9RdWVyeVN0cmluZyh1cmwsIG1zZ2lkKTtcbiAgICAgIC8vY29uc29sZS5sb2codXJsKTtcbiAgICAgIGlmKHRoaXMubGlzdGVuZXIpIHtcbiAgICAgICAgdGhyb3cgXCJ3ZWJzb2NrZXQgYWxyZWFkeSBsaXN0ZW5pbmdcIjtcbiAgICAgIH1cbiAgICAgIHRoaXMubGlzdGVuZXIgPSBuZXcgV2ViU29ja2V0KHVybCwgJ3dzK21ldGEubmNoYW4nKTtcbiAgICAgIHZhciBsID0gdGhpcy5saXN0ZW5lcjtcbiAgICAgIGwub25tZXNzYWdlID0gdWdoYmluZChmdW5jdGlvbihldnQpIHtcbiAgICAgICAgdmFyIG0gPSBldnQuZGF0YS5tYXRjaCgvXmlkOiAoLiopXFxuKGNvbnRlbnQtdHlwZTogKC4qKVxcbik/XFxuL20pO1xuICAgICAgICB0aGlzLmVtaXQoJ21lc3NhZ2UnLCBldnQuZGF0YS5zdWJzdHIobVswXS5sZW5ndGgpLCB7J2lkJzogbVsxXSwgJ2NvbnRlbnQtdHlwZSc6IG1bM119KTtcbiAgICAgIH0sIHRoaXMpO1xuICAgICAgXG4gICAgICBsLm9ub3BlbiA9IHVnaGJpbmQoZnVuY3Rpb24oZXZ0KSB7XG4gICAgICAgIHRoaXMuZW1pdCgnY29ubmVjdCcsIGV2dCk7XG4gICAgICAgIC8vY29uc29sZS5sb2coXCJjb25uZWN0XCIsIGV2dCk7XG4gICAgICB9LCB0aGlzKTtcbiAgICAgIFxuICAgICAgbC5vbmVycm9yID0gdWdoYmluZChmdW5jdGlvbihldnQpIHtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcImVycm9yXCIsIGV2dCk7XG4gICAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCBldnQsIGwpO1xuICAgICAgICBkZWxldGUgdGhpcy5saXN0ZW5lcjtcbiAgICAgIH0sIHRoaXMpO1xuICAgICAgXG4gICAgICBsLm9uY2xvc2UgPSB1Z2hiaW5kKGZ1bmN0aW9uKGV2dCkge1xuICAgICAgICB0aGlzLmVtaXQoJ19fZGlzY29ubmVjdCcsIGV2dCk7XG4gICAgICAgIGRlbGV0ZSB0aGlzLmxpc3RlbmVyO1xuICAgICAgfSwgdGhpcyk7XG4gICAgfTtcbiAgICBcbiAgICBXU1dyYXBwZXIucHJvdG90eXBlLmNhbmNlbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYodGhpcy5saXN0ZW5lcikge1xuICAgICAgICB0aGlzLmxpc3RlbmVyLmNsb3NlKCk7XG4gICAgICAgIGRlbGV0ZSB0aGlzLmxpc3RlbmVyO1xuICAgICAgfVxuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIFdTV3JhcHBlcjtcbiAgfSkoKSxcbiBcbiAgJ2V2ZW50c291cmNlJzogKGZ1bmN0aW9uKCkge1xuICAgIGZ1bmN0aW9uIEVTV3JhcHBlcihlbWl0KSB7XG4gICAgICBFdmVudFNvdXJjZTtcbiAgICAgIHRoaXMuZW1pdCA9IGVtaXQ7XG4gICAgfVxuICAgIFxuICAgIEVTV3JhcHBlci5wcm90b3R5cGUubGlzdGVuPSBmdW5jdGlvbih1cmwsIG1zZ2lkKSB7XG4gICAgICB1cmwgPSBhZGRMYXN0TXNnSWRUb1F1ZXJ5U3RyaW5nKHVybCwgbXNnaWQpO1xuICAgICAgaWYodGhpcy5saXN0ZW5lcikge1xuICAgICAgICB0aHJvdyBcInRoZXJlJ3MgYSBFUyBsaXN0ZW5lciBydW5uaW5nIGFscmVhZHlcIjtcbiAgICAgIH1cbiAgICAgIHRoaXMubGlzdGVuZXIgPSBuZXcgRXZlbnRTb3VyY2UodXJsKTtcbiAgICAgIHZhciBsID0gdGhpcy5saXN0ZW5lcjtcbiAgICAgIGwub25tZXNzYWdlID0gdWdoYmluZChmdW5jdGlvbihldnQpe1xuICAgICAgICAvL2NvbnNvbGUubG9nKFwibWVzc2FnZVwiLCBldnQpO1xuICAgICAgICB0aGlzLmVtaXQoJ21lc3NhZ2UnLCBldnQuZGF0YSwge2lkOiBldnQubGFzdEV2ZW50SWR9KTtcbiAgICAgIH0sIHRoaXMpO1xuICAgICAgXG4gICAgICBsLm9ub3BlbiA9IHVnaGJpbmQoZnVuY3Rpb24oZXZ0KSB7XG4gICAgICAgIHRoaXMucmVjb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICAgIC8vY29uc29sZS5sb2coXCJjb25uZWN0XCIsIGV2dCk7XG4gICAgICAgIHRoaXMuZW1pdCgnY29ubmVjdCcsIGV2dCk7XG4gICAgICB9LCB0aGlzKTtcbiAgICAgIFxuICAgICAgbC5vbmVycm9yID0gdWdoYmluZChmdW5jdGlvbihldnQpIHtcbiAgICAgICAgLy9FdmVudFNvdXJjZSB3aWxsIHRyeSB0byByZWNvbm5lY3QgYnkgaXRzZWxmXG4gICAgICAgIC8vY29uc29sZS5sb2coXCJvbmVycm9yXCIsIHRoaXMubGlzdGVuZXIucmVhZHlTdGF0ZSwgZXZ0KTtcbiAgICAgICAgaWYodGhpcy5saXN0ZW5lci5yZWFkeVN0YXRlID09IEV2ZW50U291cmNlLkNPTk5FQ1RJTkcgJiYgIXRoaXMucmVjb25uZWN0aW5nKSB7XG4gICAgICAgICAgaWYoIXRoaXMucmVjb25uZWN0aW5nKSB7XG4gICAgICAgICAgICB0aGlzLnJlY29ubmVjdGluZyA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmVtaXQoJ19fZGlzY29ubmVjdCcsIGV2dCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHRoaXMuZW1pdCgnX19kaXNjb25uZWN0JywgZXZ0KTtcbiAgICAgICAgICAvL2NvbnNvbGUubG9nKCdvdGhlciBfX2Rpc2Nvbm5lY3QnLCBldnQpO1xuICAgICAgICB9XG4gICAgICB9LCB0aGlzKTtcbiAgICB9O1xuICAgIFxuICAgIEVTV3JhcHBlci5wcm90b3R5cGUuY2FuY2VsPSBmdW5jdGlvbigpIHtcbiAgICAgIGlmKHRoaXMubGlzdGVuZXIpIHtcbiAgICAgICAgdGhpcy5saXN0ZW5lci5jbG9zZSgpO1xuICAgICAgICBkZWxldGUgdGhpcy5saXN0ZW5lcjtcbiAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIHJldHVybiBFU1dyYXBwZXI7XG4gIH0pKCksXG4gIFxuICAnbG9uZ3BvbGwnOiAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIExvbmdwb2xsKGVtaXQpIHtcbiAgICAgIHRoaXMuaGVhZGVycyA9IHt9O1xuICAgICAgdGhpcy5sb25nUG9sbFN0YXJ0VGltZSA9IG51bGw7XG4gICAgICB0aGlzLm1heExvbmdQb2xsVGltZSA9IDUqNjAqMTAwMDsgLy81IG1pbnV0ZXNcbiAgICAgIHRoaXMuZW1pdCA9IGVtaXQ7XG4gICAgfVxuICAgIFxuICAgIExvbmdwb2xsLnByb3RvdHlwZS5saXN0ZW4gPSBmdW5jdGlvbih1cmwsIG1zZ2lkKSB7XG4gICAgICBpZih0aGlzLnJlcSkge1xuICAgICAgICB0aHJvdyBcImFscmVhZHkgbGlzdGVuaW5nXCI7XG4gICAgICB9XG4gICAgICBpZih1cmwpIHsgdGhpcy51cmw9dXJsOyB9XG4gICAgICB2YXIgc2V0SGVhZGVyID0gdWdoYmluZChmdW5jdGlvbihpbmNvbWluZywgbmFtZSkge1xuICAgICAgICBpZihpbmNvbWluZykgeyB0aGlzLmhlYWRlcnNbbmFtZV09IGluY29taW5nOyB9XG4gICAgICB9LCB0aGlzKTtcbiAgICAgIFxuICAgICAgaWYobXNnaWQpIHtcbiAgICAgICAgdGhpcy5oZWFkZXJzID0ge1wiRXRhZ1wiOiBtc2dpZH07XG4gICAgICB9XG4gICAgICBcbiAgICAgIHRoaXMucmVxU3RhcnRUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgICBcbiAgICAgIHZhciAgcmVxdWVzdENhbGxiYWNrO1xuICAgICAgcmVxdWVzdENhbGxiYWNrID0gdWdoYmluZChmdW5jdGlvbiAoY29kZSwgcmVzcG9uc2VfdGV4dCwgcmVxKSB7XG4gICAgICAgIHNldEhlYWRlcihyZXEuZ2V0UmVzcG9uc2VIZWFkZXIoJ0xhc3QtTW9kaWZpZWQnKSwgJ0lmLU1vZGlmaWVkLVNpbmNlJyk7XG4gICAgICAgIHNldEhlYWRlcihyZXEuZ2V0UmVzcG9uc2VIZWFkZXIoJ0V0YWcnKSwgJ0lmLU5vbmUtTWF0Y2gnKTtcbiAgICAgICAgXG4gICAgICAgIGlmKGNvZGUgPj0gMjAwICYmIGNvZGUgPD0gMjEwKSB7XG4gICAgICAgICAgLy9sZWdpdCByZXBseVxuICAgICAgICAgIHZhciBjb250ZW50X3R5cGUgPSByZXEuZ2V0UmVzcG9uc2VIZWFkZXIoJ0NvbnRlbnQtVHlwZScpO1xuICAgICAgICAgIGlmICghdGhpcy5wYXJzZU11bHRpcGFydE1peGVkTWVzc2FnZShjb250ZW50X3R5cGUsIHJlc3BvbnNlX3RleHQsIHJlcSkpIHtcbiAgICAgICAgICAgIHRoaXMuZW1pdChcIm1lc3NhZ2VcIiwgcmVzcG9uc2VfdGV4dCB8fCBcIlwiLCB7J2NvbnRlbnQtdHlwZSc6IGNvbnRlbnRfdHlwZSwgJ2lkJzogdGhpcy5tc2dJZEZyb21SZXNwb25zZUhlYWRlcnMocmVxKX0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICB0aGlzLnJlcVN0YXJ0VGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgICAgICAgIHRoaXMucmVxID0gbmFub2FqYXguYWpheCh7dXJsOiB0aGlzLnVybCwgaGVhZGVyczogdGhpcy5oZWFkZXJzfSwgcmVxdWVzdENhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKChjb2RlID09IDAgJiYgcmVzcG9uc2VfdGV4dCA9PSBcIkVycm9yXCIgJiYgcmVxLnJlYWR5U3RhdGUgPT0gNCkgfHwgKGNvZGUgPT09IG51bGwgJiYgcmVzcG9uc2VfdGV4dCAhPSBcIkFib3J0XCIpKSB7XG4gICAgICAgICAgLy9jb25zb2xlLmxvZyhcImFib3J0ISEhXCIpO1xuICAgICAgICAgIHRoaXMuZW1pdChcIl9fZGlzY29ubmVjdFwiLCBjb2RlIHx8IDAsIHJlc3BvbnNlX3RleHQpO1xuICAgICAgICAgIGRlbGV0ZSB0aGlzLnJlcTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKGNvZGUgIT09IG51bGwpIHtcbiAgICAgICAgICAvL0hUVFAgZXJyb3JcbiAgICAgICAgICB0aGlzLmVtaXQoXCJlcnJvclwiLCBjb2RlLCByZXNwb25zZV90ZXh0KTtcbiAgICAgICAgICBkZWxldGUgdGhpcy5yZXE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgLy9kb24ndCBjYXJlIGFib3V0IGFib3J0aW9ucyBcbiAgICAgICAgICBkZWxldGUgdGhpcy5yZXE7XG4gICAgICAgICAgdGhpcy5lbWl0KFwiX19kaXNjb25uZWN0XCIpO1xuICAgICAgICAgIC8vY29uc29sZS5sb2coXCJhYm9ydCFcIik7XG4gICAgICAgIH1cbiAgICAgIH0sIHRoaXMpO1xuICAgICAgXG4gICAgICB0aGlzLnJlcVN0YXJ0VGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgICAgdGhpcy5yZXEgPSBuYW5vYWpheC5hamF4KHt1cmw6IHRoaXMudXJsLCBoZWFkZXJzOiB0aGlzLmhlYWRlcnN9LCByZXF1ZXN0Q2FsbGJhY2spO1xuICAgICAgdGhpcy5lbWl0KFwiY29ubmVjdFwiKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBcbiAgICBMb25ncG9sbC5wcm90b3R5cGUucGFyc2VNdWx0aXBhcnRNaXhlZE1lc3NhZ2UgPSBmdW5jdGlvbihjb250ZW50X3R5cGUsIHRleHQsIHJlcSkge1xuICAgICAgdmFyIG0gPSBjb250ZW50X3R5cGUgJiYgY29udGVudF90eXBlLm1hdGNoKC9ebXVsdGlwYXJ0XFwvbWl4ZWQ7XFxzK2JvdW5kYXJ5PSguKikkLyk7XG4gICAgICBpZighbSkgeyBcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgdmFyIGJvdW5kYXJ5ID0gbVsxXTtcbiAgICAgIFxuICAgICAgdmFyIG1zZ3MgPSB0ZXh0LnNwbGl0KFwiLS1cIiArIGJvdW5kYXJ5KTtcbiAgICAgIGlmKG1zZ3NbMF0gIT0gXCJcIiB8fCAhbXNnc1ttc2dzLmxlbmd0aC0xXS5tYXRjaCgvLS1cXHI/XFxuLykpIHsgdGhyb3cgXCJ3ZWlyZCBtdWx0aXBhcnQvbWl4ZWQgc3BsaXRcIjsgfVxuICAgICAgXG4gICAgICBtc2dzID0gbXNncy5zbGljZSgxLCAtMSk7XG4gICAgICBmb3IodmFyIGkgaW4gbXNncykge1xuICAgICAgICBtID0gbXNnc1tpXS5tYXRjaCgvXiguKilcXHI/XFxuXFxyP1xcbihbXFxzXFxTXSopXFxyP1xcbiQvbSk7XG4gICAgICAgIHZhciBoZHJzID0gbVsxXS5zcGxpdChcIlxcblwiKTtcbiAgICAgICAgXG4gICAgICAgIHZhciBtZXRhID0ge307XG4gICAgICAgIGZvcih2YXIgaiBpbiBoZHJzKSB7XG4gICAgICAgICAgdmFyIGhkciA9IGhkcnNbal0ubWF0Y2goL14oW146XSspOlxccysoLiopLyk7XG4gICAgICAgICAgaWYoaGRyICYmIGhkclsxXSA9PSBcIkNvbnRlbnQtVHlwZVwiKSB7XG4gICAgICAgICAgICBtZXRhW1wiY29udGVudC10eXBlXCJdID0gaGRyWzJdO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYoaSA9PSBtc2dzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICBtZXRhW1wiaWRcIl0gPSB0aGlzLm1zZ0lkRnJvbVJlc3BvbnNlSGVhZGVycyhyZXEpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZW1pdCgnbWVzc2FnZScsIG1bMl0sIG1ldGEpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBcbiAgICBMb25ncG9sbC5wcm90b3R5cGUubXNnSWRGcm9tUmVzcG9uc2VIZWFkZXJzID0gZnVuY3Rpb24ocmVxKSB7XG4gICAgICB2YXIgbGFzdE1vZGlmaWVkLCBldGFnO1xuICAgICAgbGFzdE1vZGlmaWVkID0gcmVxLmdldFJlc3BvbnNlSGVhZGVyKCdMYXN0LU1vZGlmaWVkJyk7XG4gICAgICBldGFnID0gcmVxLmdldFJlc3BvbnNlSGVhZGVyKCdFdGFnJyk7XG4gICAgICBpZihsYXN0TW9kaWZpZWQpIHtcbiAgICAgICAgcmV0dXJuIFwiXCIgKyBEYXRlLnBhcnNlKGxhc3RNb2RpZmllZCkvMTAwMCArIFwiOlwiICsgKGV0YWcgfHwgXCIwXCIpO1xuICAgICAgfVxuICAgICAgZWxzZSBpZihldGFnKSB7XG4gICAgICAgIHJldHVybiBldGFnO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgIH07XG4gICAgXG4gICAgTG9uZ3BvbGwucHJvdG90eXBlLmNhbmNlbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYodGhpcy5yZXEpIHtcbiAgICAgICAgdGhpcy5yZXEuYWJvcnQoKTtcbiAgICAgICAgZGVsZXRlIHRoaXMucmVxO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXM7IFxuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIExvbmdwb2xsO1xuICB9KSgpLFxuICBcbiAgJ19fc2xhdmUnOiAoZnVuY3Rpb24oKSB7XG4gICAgZnVuY3Rpb24gTG9jYWxTdG9yZVNsYXZlVHJhbnNwb3J0KGVtaXQpIHtcbiAgICAgIHRoaXMuZW1pdCA9IGVtaXQ7XG4gICAgICB0aGlzLmRvTm90UmVjb25uZWN0ID0gdHJ1ZTtcbiAgICB9XG4gICAgXG4gICAgTG9jYWxTdG9yZVNsYXZlVHJhbnNwb3J0LnByb3RvdHlwZS5saXN0ZW4gPSBmdW5jdGlvbih1cmwsIHNoYXJlZCkge1xuICAgICAgdGhpcy5zaGFyZWQgPSBzaGFyZWQ7XG4gICAgICB0aGlzLnN0YXR1c0NoYW5nZUNoZWNrZXIgPSB1Z2hiaW5kKGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgIGlmKHRoaXMuc2hhcmVkLm1hdGNoRXZlbnRLZXkoZXYsIFwibXNnXCIpKSB7XG4gICAgICAgICAgdmFyIG1zZ0lkID0gdGhpcy5zaGFyZWQuZ2V0KFwibXNnOmlkXCIpO1xuICAgICAgICAgIHZhciBjb250ZW50VHlwZSA9IHRoaXMuc2hhcmVkLmdldChcIm1zZzpjb250ZW50LXR5cGVcIik7XG4gICAgICAgICAgdmFyIG1zZyA9IHRoaXMuc2hhcmVkLmdldChcIm1zZ1wiKTtcbiAgICAgICAgICB0aGlzLmVtaXQoJ21lc3NhZ2UnLCBtc2csIHsnaWQnOiBtc2dJZCA9PSBcIlwiID8gdW5kZWZpbmVkIDogbXNnSWQsICdjb250ZW50LXR5cGUnOiBjb250ZW50VHlwZSA9PSBcIlwiID8gdW5kZWZpbmVkIDogY29udGVudFR5cGV9KTtcbiAgICAgICAgfVxuICAgICAgfSwgdGhpcyk7XG4gICAgICBnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcihcInN0b3JhZ2VcIiwgdGhpcy5zdGF0dXNDaGFuZ2VDaGVja2VyKTtcbiAgICB9O1xuICAgICAgXG4gICAgTG9jYWxTdG9yZVNsYXZlVHJhbnNwb3J0LnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbigpIHtcbiAgICAgIGdsb2JhbC5yZW1vdmVFdmVudExpc3RlbmVyKFwic3RvcmFnZVwiLCB0aGlzLnN0YXR1c0NoYW5nZUNoZWNrZXIpO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIExvY2FsU3RvcmVTbGF2ZVRyYW5zcG9ydDtcbiAgfSkoKVxuXG59O1xuXG5yZXR1cm4gTmNoYW5TdWJzY3JpYmVyO1xufSk7XG5cbiJdfQ==
